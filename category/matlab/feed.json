{
    "version": "https://jsonfeed.org/version/1",
    "title": "Chih Chia's Blog • All posts by \"matlab\" category",
    "description": "",
    "home_page_url": "https://to-pro.github.io",
    "items": [
        {
            "id": "https://to-pro.github.io/matlab/lesson4/",
            "url": "https://to-pro.github.io/matlab/lesson4/",
            "title": "動畫 lesson 4",
            "date_published": "2024-10-23T09:49:20.501Z",
            "content_html": "<p>結合前面的介紹，我們可以將無人機飛行模擬結果繪製成動畫。</p>\n<p>範例中的 MAT 檔 (auto_fly_90.mat) 裡面有兩個結構變數分別是飛行資料 data 和期望軌跡 desired_trajectory</p>\n<ul>\n<li>\n<p>data:</p>\n<ul>\n<li>t: 時間</li>\n<li>x: 無人機 x 位置</li>\n<li>y: 無人機 y 位置</li>\n<li>z: 無人機 z 位置</li>\n<li>P:[x;y;z] 無人機位置</li>\n<li>phi,theta,psi: 無人機姿態</li>\n</ul>\n</li>\n<li>\n<p>desired_trajectory:</p>\n<ul>\n<li>waypoint: 航點</li>\n<li>x_d: 無人機期望 x 位置</li>\n<li>y_d: 無人機期望 y 位置</li>\n<li>z_d: 無人機期望 z 位置</li>\n<li>phi_d,theta_d,psi_d: 無人機期望姿態</li>\n<li>p: 小圖期望位置</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"成果展示\"><a class=\"anchor\" href=\"#成果展示\">#</a> 成果展示:</h3>\n<p><img data-src=\"https://imgur.com/8TjEUiE.jpg\" alt=\"Imgur\" /></p>\n<p>範例的 STL 與 MAT 可以在這邊下載:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2RyaXZlL2ZvbGRlcnMvMUxBbUlWNzFuUTRtaHVQUWxnWm5PNDVGZjBKUEN2Z3Z3P3VzcD1kcml2ZV9saW5r\"> 載點</span></p>\n<h3 id=\"程式碼\"><a class=\"anchor\" href=\"#程式碼\">#</a> 程式碼:</h3>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">% 全地圖畫法</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>clc<span class=\"token punctuation\">;</span>clear<span class=\"token punctuation\">;</span>close all<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>addpath <span class=\"token string\">'Z:\\My Drive\\MATLAB\\plot_function'</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">addpath</span><span class=\"token punctuation\">(</span><span class=\"token function\">genpath</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.\\STL\\450'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>load auto_fly_90<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>video_name<span class=\"token operator\">=</span><span class=\"token string\">'auto_fly_90'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">% 使用者設定開始</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>fuselage_color <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>propeller_color <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>data_color <span class=\"token operator\">=</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>stl_amplification <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>reference_color <span class=\"token operator\">=</span> <span class=\"token string\">'g'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>waypoint_color <span class=\"token operator\">=</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>time_window <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span><span class=\"token comment\">%sec</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">% 使用者設定結束</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">%% 繪製動畫準備</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>video<span class=\"token operator\">=</span><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">,</span><span class=\"token string\">'Position'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span> <span class=\"token number\">49</span> <span class=\"token number\">1.7067e+03</span> <span class=\"token number\">946</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'color'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 需放大錄製，不然畫質很差</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Position'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0.06</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.035</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.7</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.95</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>g_main <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">% 透明球 (避免邊界隨螺旋槳變化)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">[</span>bal<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span>bal<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">,</span>bal<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sphere<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>bal<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>x<span class=\"token operator\">*</span><span class=\"token number\">0.5</span><span class=\"token operator\">*</span>stl_amplification<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>bal<span class=\"token punctuation\">.</span>y <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>y<span class=\"token operator\">*</span><span class=\"token number\">0.5</span><span class=\"token operator\">*</span>stl_amplification<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>bal<span class=\"token punctuation\">.</span>z <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>z<span class=\"token operator\">*</span><span class=\"token number\">0.5</span><span class=\"token operator\">*</span>stl_amplification<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>ball <span class=\"token operator\">=</span> <span class=\"token function\">surf</span><span class=\"token punctuation\">(</span>bal<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span>bal<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">,</span>bal<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">,</span>\"FaceAlpha\"<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"none\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\">% 機架</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>F450_raw <span class=\"token operator\">=</span> <span class=\"token function\">stlread</span><span class=\"token punctuation\">(</span>\"F450_no_propeller<span class=\"token punctuation\">.</span>stl\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>F450_poinit <span class=\"token operator\">=</span> stl_amplification<span class=\"token operator\">*</span>F450_raw<span class=\"token punctuation\">.</span>Points<span class=\"token punctuation\">;</span>           <span class=\"token comment\">% 取點</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>F450_conn <span class=\"token operator\">=</span> F450_raw<span class=\"token punctuation\">.</span>ConnectivityList<span class=\"token punctuation\">;</span>   <span class=\"token comment\">% 取三角形</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>clear F450_raw<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>F450_triang <span class=\"token operator\">=</span> <span class=\"token function\">triangulation</span><span class=\"token punctuation\">(</span>F450_conn<span class=\"token punctuation\">,</span>F450_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>F450 <span class=\"token operator\">=</span> <span class=\"token function\">trisurf</span><span class=\"token punctuation\">(</span>F450_triang<span class=\"token punctuation\">,</span><span class=\"token string\">'facecolor'</span><span class=\"token punctuation\">,</span>fuselage_color<span class=\"token punctuation\">,</span><span class=\"token string\">'edgecolor'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token comment\">% 槳葉</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>propeller_raw <span class=\"token operator\">=</span> <span class=\"token function\">stlread</span><span class=\"token punctuation\">(</span>\"propeller<span class=\"token punctuation\">.</span>stl\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>propeller_poinit <span class=\"token operator\">=</span> stl_amplification<span class=\"token operator\">*</span>propeller_raw<span class=\"token punctuation\">.</span>Points<span class=\"token punctuation\">;</span>           <span class=\"token comment\">% 取點</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>propeller_conn <span class=\"token operator\">=</span> propeller_raw<span class=\"token punctuation\">.</span>ConnectivityList<span class=\"token punctuation\">;</span>   <span class=\"token comment\">% 取三角形</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>clear propeller_raw<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>propeller_triang <span class=\"token operator\">=</span> <span class=\"token function\">triangulation</span><span class=\"token punctuation\">(</span>propeller_conn<span class=\"token punctuation\">,</span>propeller_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    propeller<span class=\"token punctuation\">&#123;</span><span class=\"token number\">i</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token function\">trisurf</span><span class=\"token punctuation\">(</span>propeller_triang<span class=\"token punctuation\">,</span><span class=\"token string\">'facecolor'</span><span class=\"token punctuation\">,</span>propeller_color<span class=\"token punctuation\">,</span><span class=\"token string\">'edgecolor'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>propeller_RT_B_to_motor <span class=\"token operator\">=</span> <span class=\"token function\">cell</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>propeller_deg <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">pi</span><span class=\"token operator\">*</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">pi</span><span class=\"token operator\">*</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">pi</span><span class=\"token operator\">*</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">pi</span><span class=\"token operator\">*</span><span class=\"token number\">0.4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre><span class=\"token comment\">%% 開燈</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token function\">camlight</span><span class=\"token punctuation\">(</span>\"headlight\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token comment\">%% 文字設定</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>digits_set<span class=\"token operator\">=</span><span class=\"token string\">'%5.2f'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>Time_txt<span class=\"token operator\">=</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'String'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token string\">'time: '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'00.00'</span> <span class=\"token punctuation\">,</span><span class=\"token string\">' s'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>              <span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>              <span class=\"token string\">'FontSize'</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>              <span class=\"token string\">'Units'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'normalized'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>              <span class=\"token string\">'Position'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span> <span class=\"token number\">0.05</span> <span class=\"token number\">0.95</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre></pre></td></tr><tr><td data-num=\"77\"></td><td><pre><span class=\"token comment\">% t = data.t(1:3000);</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>t <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>t<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>dt <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre><span class=\"token comment\">%% 初始狀態</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre><span class=\"token comment\">% 透明球</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>ball<span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>ball<span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>ball<span class=\"token punctuation\">.</span>ZData <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>z <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token comment\">% 機架</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>F450_dcm <span class=\"token operator\">=</span> <span class=\"token function\">angle2dcm</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">psi</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">theta</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">phi</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>F450_RT <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>F450_dcm<span class=\"token operator\">'</span><span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>F450_F450_poinit_new  <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>F450_RT<span class=\"token operator\">*</span><span class=\"token punctuation\">[</span>F450_poinit<span class=\"token operator\">'</span><span class=\"token punctuation\">;</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>F450_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>F450_F450_poinit_new<span class=\"token operator\">=</span><span class=\"token function\">F450_F450_poinit_new</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>F450<span class=\"token punctuation\">.</span>Vertices <span class=\"token operator\">=</span> F450_F450_poinit_new<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre></pre></td></tr><tr><td data-num=\"94\"></td><td><pre><span class=\"token comment\">% 槳葉</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>propeller_offset<span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span> <span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span>  <span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token number\">196.7500</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">0.001</span><span class=\"token operator\">*</span>stl_amplification<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>propeller_offset<span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span>  <span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token number\">196.7500</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">0.001</span><span class=\"token operator\">*</span>stl_amplification<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>propeller_offset<span class=\"token punctuation\">&#123;</span><span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">-</span><span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token number\">196.7500</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">0.001</span><span class=\"token operator\">*</span>stl_amplification<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>propeller_offset<span class=\"token punctuation\">&#123;</span><span class=\"token number\">4</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span> <span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">-</span><span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token number\">196.7500</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">0.001</span><span class=\"token operator\">*</span>stl_amplification<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre></pre></td></tr><tr><td data-num=\"100\"></td><td><pre></pre></td></tr><tr><td data-num=\"101\"></td><td><pre></pre></td></tr><tr><td data-num=\"102\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>    propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">i</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">angle2dcm</span><span class=\"token punctuation\">(</span><span class=\"token function\">propeller_deg</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span> propeller_offset<span class=\"token punctuation\">&#123;</span><span class=\"token number\">i</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>    propeller_F450_poinit_new  <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>F450_RT<span class=\"token operator\">*</span>propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">i</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">*</span><span class=\"token punctuation\">[</span>propeller_poinit<span class=\"token operator\">'</span><span class=\"token punctuation\">;</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>propeller_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>    propeller_F450_poinit_new<span class=\"token operator\">=</span><span class=\"token function\">propeller_F450_poinit_new</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>    propeller<span class=\"token punctuation\">&#123;</span><span class=\"token number\">i</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>Vertices <span class=\"token operator\">=</span> propeller_F450_poinit_new<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre></pre></td></tr><tr><td data-num=\"109\"></td><td><pre></pre></td></tr><tr><td data-num=\"110\"></td><td><pre><span class=\"token comment\">%% 全部的軌跡</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>data_Trajectory_point<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>data_Trajectory<span class=\"token operator\">=</span><span class=\"token function\">plot3</span><span class=\"token punctuation\">(</span><span class=\"token function\">data_Trajectory_point</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">data_Trajectory_point</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">data_Trajectory_point</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>    <span class=\"token string\">'-o'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'MarkerSize'</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token string\">'MarkerFaceColor'</span><span class=\"token punctuation\">,</span>data_color <span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token string\">'MarkerEdgeColor'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'none'</span><span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Color'</span><span class=\"token punctuation\">,</span>data_color<span class=\"token punctuation\">,</span><span class=\"token string\">'MarkerIndices'</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token operator\">:</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre></pre></td></tr><tr><td data-num=\"116\"></td><td><pre></pre></td></tr><tr><td data-num=\"117\"></td><td><pre></pre></td></tr><tr><td data-num=\"118\"></td><td><pre><span class=\"token comment\">%% 航點與期望軌跡</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"121\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot3</span><span class=\"token punctuation\">(</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>reference_color<span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"123\"></td><td><pre><span class=\"token function\">plot3</span><span class=\"token punctuation\">(</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">waypoint</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">waypoint</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">waypoint</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>waypoint_color<span class=\"token punctuation\">,</span><span class=\"token string\">'LineStyle'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'-.'</span><span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"125\"></td><td><pre><span class=\"token function\">plot3</span><span class=\"token punctuation\">(</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">waypoint</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">waypoint</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">waypoint</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'o'</span><span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>reference_color<span class=\"token punctuation\">,</span><span class=\"token string\">'LineStyle'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'none'</span><span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"127\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot3</span><span class=\"token punctuation\">(</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">waypoint</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">waypoint</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">waypoint</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'o'</span><span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>waypoint_color<span class=\"token punctuation\">,</span><span class=\"token string\">'LineStyle'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'none'</span><span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre></pre></td></tr><tr><td data-num=\"129\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>p data_Trajectory<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Waypoint'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Desired trajectory'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Cascade PID'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Location'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.5955</span> <span class=\"token number\">0.9003</span> <span class=\"token number\">0.1107</span> <span class=\"token number\">0.0751</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre></pre></td></tr><tr><td data-num=\"131\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token function\">X</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token function\">Y</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre><span class=\"token function\">zlabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token function\">Z</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre></pre></td></tr><tr><td data-num=\"135\"></td><td><pre></pre></td></tr><tr><td data-num=\"136\"></td><td><pre><span class=\"token comment\">% axis equal;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>axis padded</pre></td></tr><tr><td data-num=\"138\"></td><td><pre>grid on<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre><span class=\"token function\">view</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre></pre></td></tr><tr><td data-num=\"142\"></td><td><pre></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>writerObj <span class=\"token operator\">=</span> <span class=\"token function\">VideoWriter</span><span class=\"token punctuation\">(</span>video_name<span class=\"token punctuation\">,</span><span class=\"token string\">'MPEG-4'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>writerObj<span class=\"token punctuation\">.</span>FrameRate <span class=\"token operator\">=</span> <span class=\"token number\">25</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>writerObj<span class=\"token punctuation\">.</span>Quality <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token function\">length</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre></pre></td></tr><tr><td data-num=\"149\"></td><td><pre></pre></td></tr><tr><td data-num=\"150\"></td><td><pre><span class=\"token comment\">%% 其他子圖</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>RAD2DEG <span class=\"token operator\">=</span> <span class=\"token number\">180</span><span class=\"token operator\">/</span><span class=\"token keyword\">pi</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"152\"></td><td><pre>p_y <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>       data<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>       data<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>       RAD2DEG<span class=\"token operator\">*</span>data<span class=\"token punctuation\">.</span>phi<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>       RAD2DEG<span class=\"token operator\">*</span>data<span class=\"token punctuation\">.</span>theta<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>       RAD2DEG<span class=\"token operator\">*</span>data<span class=\"token punctuation\">.</span>psi<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre></pre></td></tr><tr><td data-num=\"159\"></td><td><pre><span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span>\"Position\"<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.78</span> <span class=\"token number\">0.82</span> <span class=\"token number\">0.2</span> <span class=\"token number\">0.13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>data_color<span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"162\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span><span class=\"token operator\">-</span>\"<span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>reference_color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>gca<span class=\"token punctuation\">,</span><span class=\"token string\">'xticklabel'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"$x$ <span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre></pre></td></tr><tr><td data-num=\"168\"></td><td><pre><span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span>\"Position\"<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.78</span> <span class=\"token number\">0.67</span> <span class=\"token number\">0.2</span> <span class=\"token number\">0.13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>data_color<span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"171\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span><span class=\"token operator\">-</span>\"<span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>reference_color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>gca<span class=\"token punctuation\">,</span><span class=\"token string\">'xticklabel'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"$y$ <span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre></pre></td></tr><tr><td data-num=\"177\"></td><td><pre><span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span>\"Position\"<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.78</span> <span class=\"token number\">0.52</span> <span class=\"token number\">0.2</span> <span class=\"token number\">0.13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>data_color<span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"180\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span><span class=\"token operator\">-</span>\"<span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>reference_color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>gca<span class=\"token punctuation\">,</span><span class=\"token string\">'xticklabel'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"$z$ <span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre></pre></td></tr><tr><td data-num=\"186\"></td><td><pre><span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span>\"Position\"<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.78</span> <span class=\"token number\">0.37</span> <span class=\"token number\">0.2</span> <span class=\"token number\">0.13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Color'</span><span class=\"token punctuation\">,</span>data_color<span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>gca<span class=\"token punctuation\">,</span><span class=\"token string\">'xticklabel'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"$<span class=\"token operator\">\\</span>phi$ <span class=\"token punctuation\">(</span>$<span class=\"token operator\">^</span><span class=\"token punctuation\">&#123;</span><span class=\"token operator\">\\</span>circ<span class=\"token punctuation\">&#125;</span>$<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre></pre></td></tr><tr><td data-num=\"193\"></td><td><pre><span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span>\"Position\"<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.78</span> <span class=\"token number\">0.22</span> <span class=\"token number\">0.2</span> <span class=\"token number\">0.13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Color'</span><span class=\"token punctuation\">,</span>data_color<span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>gca<span class=\"token punctuation\">,</span><span class=\"token string\">'xticklabel'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"$<span class=\"token operator\">\\</span>theta$ <span class=\"token punctuation\">(</span>$<span class=\"token operator\">^</span><span class=\"token punctuation\">&#123;</span><span class=\"token operator\">\\</span>circ<span class=\"token punctuation\">&#125;</span>$<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre></pre></td></tr><tr><td data-num=\"200\"></td><td><pre><span class=\"token function\">subplot</span><span class=\"token punctuation\">(</span>\"Position\"<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.78</span> <span class=\"token number\">0.07</span> <span class=\"token number\">0.2</span> <span class=\"token number\">0.13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Color'</span><span class=\"token punctuation\">,</span>data_color<span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"203\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>RAD2DEG<span class=\"token operator\">*</span>desired_trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">psi_d</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span><span class=\"token operator\">-</span>\"<span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>reference_color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"$<span class=\"token operator\">\\</span>psi$ <span class=\"token punctuation\">(</span>$<span class=\"token operator\">^</span><span class=\"token punctuation\">&#123;</span><span class=\"token operator\">\\</span>circ<span class=\"token punctuation\">&#125;</span>$<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token function\">Time</span> <span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre><span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"207\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre></pre></td></tr><tr><td data-num=\"209\"></td><td><pre></pre></td></tr><tr><td data-num=\"210\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">j</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>    time <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre>    <span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> time<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>    <span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> <span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre>    min_p_y <span class=\"token operator\">=</span> <span class=\"token function\">min</span><span class=\"token punctuation\">(</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>    max_p_y <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre>    lim_y_offset <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_p_y<span class=\"token operator\">-</span>min_p_y<span class=\"token punctuation\">)</span><span class=\"token operator\">></span>lim_y_offset</pre></td></tr><tr><td data-num=\"218\"></td><td><pre>        lim_y_offset <span class=\"token operator\">=</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_p_y<span class=\"token operator\">-</span>min_p_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>    <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>    <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>YLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>min_p_y<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset max_p_y<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>time <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.7</span><span class=\"token operator\">*</span>time_window<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>        <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>XLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span> time_window<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre>        <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>XLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>time<span class=\"token operator\">-</span><span class=\"token number\">0.7</span><span class=\"token operator\">*</span>time_window time<span class=\"token operator\">+</span><span class=\"token number\">0.3</span><span class=\"token operator\">*</span>time_window<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre>    <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"227\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre><span class=\"token comment\">%% 繪製動畫準備結束</span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre></pre></td></tr><tr><td data-num=\"230\"></td><td><pre><span class=\"token comment\">%% 起始前暫停影像</span></pre></td></tr><tr><td data-num=\"231\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">25</span></pre></td></tr><tr><td data-num=\"232\"></td><td><pre>     <span class=\"token function\">writeVideo</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">,</span><span class=\"token function\">getframe</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"234\"></td><td><pre><span class=\"token comment\">%%%</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre></pre></td></tr><tr><td data-num=\"236\"></td><td><pre><span class=\"token comment\">%% 開始錄製</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span>n<span class=\"token operator\">/</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre>ii<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token operator\">*</span><span class=\"token number\">i</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"239\"></td><td><pre><span class=\"token comment\">% 透明球</span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre>ball<span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre>ball<span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"242\"></td><td><pre>ball<span class=\"token punctuation\">.</span>ZData <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>z <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre></pre></td></tr><tr><td data-num=\"244\"></td><td><pre><span class=\"token comment\">% 機架</span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre>F450_dcm <span class=\"token operator\">=</span> <span class=\"token function\">angle2dcm</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">psi</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">theta</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">phi</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"246\"></td><td><pre>F450_RT <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>F450_dcm<span class=\"token operator\">'</span><span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"247\"></td><td><pre>F450_F450_poinit_new  <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>F450_RT<span class=\"token operator\">*</span><span class=\"token punctuation\">[</span>F450_poinit<span class=\"token operator\">'</span><span class=\"token punctuation\">;</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>F450_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"248\"></td><td><pre>F450_F450_poinit_new<span class=\"token operator\">=</span><span class=\"token function\">F450_F450_poinit_new</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"249\"></td><td><pre>F450<span class=\"token punctuation\">.</span>Vertices <span class=\"token operator\">=</span> F450_F450_poinit_new<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"250\"></td><td><pre></pre></td></tr><tr><td data-num=\"251\"></td><td><pre><span class=\"token comment\">% 槳葉</span></pre></td></tr><tr><td data-num=\"252\"></td><td><pre></pre></td></tr><tr><td data-num=\"253\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">j</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"254\"></td><td><pre>    <span class=\"token function\">propeller_deg</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">propeller_deg</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">0.3</span><span class=\"token operator\">*</span><span class=\"token keyword\">pi</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"255\"></td><td><pre>    propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">j</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">angle2dcm</span><span class=\"token punctuation\">(</span><span class=\"token function\">propeller_deg</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span> propeller_offset<span class=\"token punctuation\">&#123;</span><span class=\"token number\">j</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"256\"></td><td><pre>    propeller_F450_poinit_new  <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>F450_RT<span class=\"token operator\">*</span>propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">j</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">*</span><span class=\"token punctuation\">[</span>propeller_poinit<span class=\"token operator\">'</span><span class=\"token punctuation\">;</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>propeller_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"257\"></td><td><pre>    propeller_F450_poinit_new<span class=\"token operator\">=</span><span class=\"token function\">propeller_F450_poinit_new</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"258\"></td><td><pre>    propeller<span class=\"token punctuation\">&#123;</span><span class=\"token number\">j</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>Vertices <span class=\"token operator\">=</span> propeller_F450_poinit_new<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"259\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"260\"></td><td><pre></pre></td></tr><tr><td data-num=\"261\"></td><td><pre>data_Trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">XData</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">i</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"262\"></td><td><pre>data_Trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">YData</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">i</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"263\"></td><td><pre>data_Trajectory<span class=\"token punctuation\">.</span><span class=\"token function\">ZData</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">i</span><span class=\"token operator\">:</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"264\"></td><td><pre></pre></td></tr><tr><td data-num=\"265\"></td><td><pre><span class=\"token comment\">% 子圖更新</span></pre></td></tr><tr><td data-num=\"266\"></td><td><pre>time <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"267\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">j</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"268\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"269\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>time <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.7</span><span class=\"token operator\">*</span>time_window<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"270\"></td><td><pre>        <span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"271\"></td><td><pre>        <span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> <span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"272\"></td><td><pre>        min_p_y <span class=\"token operator\">=</span> <span class=\"token function\">min</span><span class=\"token punctuation\">(</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"273\"></td><td><pre>        max_p_y <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"274\"></td><td><pre>        lim_y_offset <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"275\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_p_y<span class=\"token operator\">-</span>min_p_y<span class=\"token punctuation\">)</span><span class=\"token operator\">></span>lim_y_offset</pre></td></tr><tr><td data-num=\"276\"></td><td><pre>            lim_y_offset <span class=\"token operator\">=</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_p_y<span class=\"token operator\">-</span>min_p_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"277\"></td><td><pre>        <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"278\"></td><td><pre>        <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>YLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>min_p_y<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset max_p_y<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"279\"></td><td><pre>        <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>XLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span> time_window<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"280\"></td><td><pre>    <span class=\"token keyword\">else</span> </pre></td></tr><tr><td data-num=\"281\"></td><td><pre>        <span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"282\"></td><td><pre>        <span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> <span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"283\"></td><td><pre>        min_p_y <span class=\"token operator\">=</span> <span class=\"token function\">min</span><span class=\"token punctuation\">(</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">,</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>ii<span class=\"token operator\">-</span><span class=\"token number\">0.7</span><span class=\"token operator\">*</span>time_window<span class=\"token operator\">/</span>dt<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"284\"></td><td><pre>        max_p_y <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">p_y</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">,</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>ii<span class=\"token operator\">-</span><span class=\"token number\">0.7</span><span class=\"token operator\">*</span>time_window<span class=\"token operator\">/</span>dt<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"285\"></td><td><pre>        lim_y_offset <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"286\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_p_y<span class=\"token operator\">-</span>min_p_y<span class=\"token punctuation\">)</span><span class=\"token operator\">></span>lim_y_offset</pre></td></tr><tr><td data-num=\"287\"></td><td><pre>            lim_y_offset <span class=\"token operator\">=</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_p_y<span class=\"token operator\">-</span>min_p_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"288\"></td><td><pre>        <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"289\"></td><td><pre>        <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>YLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>min_p_y<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset max_p_y<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"290\"></td><td><pre>        <span class=\"token keyword\">if</span> time<span class=\"token operator\">+</span><span class=\"token number\">0.3</span><span class=\"token operator\">*</span>time_window <span class=\"token operator\">&lt;</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"291\"></td><td><pre>            <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>XLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>time<span class=\"token operator\">-</span><span class=\"token number\">0.7</span><span class=\"token operator\">*</span>time_window time<span class=\"token operator\">+</span><span class=\"token number\">0.3</span><span class=\"token operator\">*</span>time_window<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"292\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"293\"></td><td><pre>            <span class=\"token function\">g</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>XLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>time_window <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"294\"></td><td><pre>        <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"295\"></td><td><pre>    <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"296\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"297\"></td><td><pre></pre></td></tr><tr><td data-num=\"298\"></td><td><pre><span class=\"token comment\">%% 字體</span></pre></td></tr><tr><td data-num=\"299\"></td><td><pre>Time_txt<span class=\"token punctuation\">.</span>String<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'time: '</span><span class=\"token punctuation\">,</span> <span class=\"token function\">num2str</span><span class=\"token punctuation\">(</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'%5.2f'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span><span class=\"token string\">' s'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"300\"></td><td><pre></pre></td></tr><tr><td data-num=\"301\"></td><td><pre></pre></td></tr><tr><td data-num=\"302\"></td><td><pre>drawnow limitrate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"303\"></td><td><pre><span class=\"token function\">writeVideo</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">,</span><span class=\"token function\">getframe</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"304\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"305\"></td><td><pre></pre></td></tr><tr><td data-num=\"306\"></td><td><pre><span class=\"token comment\">%% 最後暫停畫面</span></pre></td></tr><tr><td data-num=\"307\"></td><td><pre>ii<span class=\"token operator\">=</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"308\"></td><td><pre><span class=\"token comment\">% 透明球</span></pre></td></tr><tr><td data-num=\"309\"></td><td><pre>ball<span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"310\"></td><td><pre>ball<span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"311\"></td><td><pre>ball<span class=\"token punctuation\">.</span>ZData <span class=\"token operator\">=</span> bal<span class=\"token punctuation\">.</span>z <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"312\"></td><td><pre></pre></td></tr><tr><td data-num=\"313\"></td><td><pre><span class=\"token comment\">% 機架</span></pre></td></tr><tr><td data-num=\"314\"></td><td><pre>F450_dcm <span class=\"token operator\">=</span> <span class=\"token function\">angle2dcm</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">psi</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">theta</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">phi</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"315\"></td><td><pre>F450_RT <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>F450_dcm<span class=\"token operator\">'</span><span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">P</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"316\"></td><td><pre>F450_F450_poinit_new  <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>F450_RT<span class=\"token operator\">*</span><span class=\"token punctuation\">[</span>F450_poinit<span class=\"token operator\">'</span><span class=\"token punctuation\">;</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>F450_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"317\"></td><td><pre>F450_F450_poinit_new<span class=\"token operator\">=</span><span class=\"token function\">F450_F450_poinit_new</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"318\"></td><td><pre>F450<span class=\"token punctuation\">.</span>Vertices <span class=\"token operator\">=</span> F450_F450_poinit_new<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"319\"></td><td><pre></pre></td></tr><tr><td data-num=\"320\"></td><td><pre><span class=\"token comment\">% 槳葉</span></pre></td></tr><tr><td data-num=\"321\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">j</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"322\"></td><td><pre>    <span class=\"token function\">propeller_deg</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">propeller_deg</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">0.3</span><span class=\"token operator\">*</span><span class=\"token keyword\">pi</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"323\"></td><td><pre>    propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">j</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">angle2dcm</span><span class=\"token punctuation\">(</span><span class=\"token function\">propeller_deg</span><span class=\"token punctuation\">(</span><span class=\"token number\">j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span> propeller_offset<span class=\"token punctuation\">&#123;</span><span class=\"token number\">j</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"324\"></td><td><pre>    propeller_F450_poinit_new  <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>F450_RT<span class=\"token operator\">*</span>propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">j</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">*</span><span class=\"token punctuation\">[</span>propeller_poinit<span class=\"token operator\">'</span><span class=\"token punctuation\">;</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>propeller_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"325\"></td><td><pre>    propeller_F450_poinit_new<span class=\"token operator\">=</span><span class=\"token function\">propeller_F450_poinit_new</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"326\"></td><td><pre>    propeller<span class=\"token punctuation\">&#123;</span><span class=\"token number\">j</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>Vertices <span class=\"token operator\">=</span> propeller_F450_poinit_new<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"327\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"328\"></td><td><pre></pre></td></tr><tr><td data-num=\"329\"></td><td><pre><span class=\"token comment\">%% 字體</span></pre></td></tr><tr><td data-num=\"330\"></td><td><pre>Time_txt<span class=\"token punctuation\">.</span>String<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'time: '</span><span class=\"token punctuation\">,</span> <span class=\"token function\">num2str</span><span class=\"token punctuation\">(</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'%5.2f'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span><span class=\"token string\">' s'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"331\"></td><td><pre>drawnow limitrate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"332\"></td><td><pre><span class=\"token function\">writeVideo</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">,</span><span class=\"token function\">getframe</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"333\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">25</span><span class=\"token comment\">% 結束暫停影像</span></pre></td></tr><tr><td data-num=\"334\"></td><td><pre>    <span class=\"token function\">writeVideo</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">,</span><span class=\"token function\">getframe</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"335\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"336\"></td><td><pre><span class=\"token comment\">%%%</span></pre></td></tr><tr><td data-num=\"337\"></td><td><pre><span class=\"token function\">close</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"338\"></td><td><pre></pre></td></tr><tr><td data-num=\"339\"></td><td><pre><span class=\"token keyword\">function</span> new_data<span class=\"token operator\">=</span><span class=\"token function\">col_row_check</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"340\"></td><td><pre>   new_data<span class=\"token operator\">=</span>data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"341\"></td><td><pre>   <span class=\"token punctuation\">[</span>m<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"342\"></td><td><pre>   <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>m<span class=\"token operator\">></span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"343\"></td><td><pre>     new_data <span class=\"token operator\">=</span> new_data<span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"344\"></td><td><pre>   <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"345\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://to-pro.github.io/matlab/lesson3/",
            "url": "https://to-pro.github.io/matlab/lesson3/",
            "title": "動畫 lesson 3",
            "date_published": "2024-10-23T09:49:19.272Z",
            "content_html": "<p>這一篇基於前一篇引入 STL 後，將四旋翼模型拆分成機架與槳葉。這樣拆分引入可以在後面繪製動畫時使螺旋槳各自轉動。</p>\n<h3 id=\"成果展示\"><a class=\"anchor\" href=\"#成果展示\">#</a> 成果展示:</h3>\n<p><img data-src=\"https://imgur.com/dGp7Pfz.jpg\" alt=\"Imgur\" /></p>\n<p>範例的 STL 可以在這邊下載:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2RyaXZlL2ZvbGRlcnMvMUxBbUlWNzFuUTRtaHVQUWxnWm5PNDVGZjBKUEN2Z3Z3P3VzcD1kcml2ZV9saW5r\"> 載點</span></p>\n<h3 id=\"程式碼\"><a class=\"anchor\" href=\"#程式碼\">#</a> 程式碼:</h3>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>clc<span class=\"token punctuation\">;</span>clear<span class=\"token punctuation\">;</span>close all</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">addpath</span><span class=\"token punctuation\">(</span><span class=\"token function\">genpath</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.\\450'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">% 路徑可能需要更改</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">% 機架</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>F450_raw <span class=\"token operator\">=</span> <span class=\"token function\">stlread</span><span class=\"token punctuation\">(</span>\"F450_no_propeller<span class=\"token punctuation\">.</span>stl\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>F450_poinit <span class=\"token operator\">=</span> F450_raw<span class=\"token punctuation\">.</span>Points<span class=\"token punctuation\">;</span>           <span class=\"token comment\">% 取點</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>F450_conn <span class=\"token operator\">=</span> F450_raw<span class=\"token punctuation\">.</span>ConnectivityList<span class=\"token punctuation\">;</span>   <span class=\"token comment\">% 取三角形</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>clear F450_raw<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>F450_triang <span class=\"token operator\">=</span> <span class=\"token function\">triangulation</span><span class=\"token punctuation\">(</span>F450_conn<span class=\"token punctuation\">,</span>F450_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>F450 <span class=\"token operator\">=</span> <span class=\"token function\">trisurf</span><span class=\"token punctuation\">(</span>F450_triang<span class=\"token punctuation\">,</span><span class=\"token string\">'facecolor'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'edgecolor'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">% 槳葉</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>propeller_raw <span class=\"token operator\">=</span> <span class=\"token function\">stlread</span><span class=\"token punctuation\">(</span>\"propeller<span class=\"token punctuation\">.</span>stl\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>propeller_poinit <span class=\"token operator\">=</span> propeller_raw<span class=\"token punctuation\">.</span>Points<span class=\"token punctuation\">;</span>           <span class=\"token comment\">% 取點</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>propeller_conn <span class=\"token operator\">=</span> propeller_raw<span class=\"token punctuation\">.</span>ConnectivityList<span class=\"token punctuation\">;</span>   <span class=\"token comment\">% 取三角形</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>clear propeller_raw<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>propeller_triang <span class=\"token operator\">=</span> <span class=\"token function\">triangulation</span><span class=\"token punctuation\">(</span>propeller_conn<span class=\"token punctuation\">,</span>propeller_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    propeller<span class=\"token punctuation\">&#123;</span><span class=\"token number\">i</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token function\">trisurf</span><span class=\"token punctuation\">(</span>propeller_triang<span class=\"token punctuation\">,</span><span class=\"token string\">'facecolor'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'edgecolor'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>propeller_RT_B_to_motor <span class=\"token operator\">=</span> <span class=\"token function\">cell</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">angle2dcm</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">pi</span><span class=\"token operator\">*</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span> <span class=\"token punctuation\">[</span> <span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span>  <span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token number\">196.7500</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">0.001</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">angle2dcm</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">pi</span><span class=\"token operator\">*</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span>  <span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token number\">196.7500</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">0.001</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">angle2dcm</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">pi</span><span class=\"token operator\">*</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">-</span><span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token number\">196.7500</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">0.001</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">4</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">angle2dcm</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">pi</span><span class=\"token operator\">*</span><span class=\"token number\">0.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span> <span class=\"token punctuation\">[</span> <span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">-</span><span class=\"token number\">159.1</span><span class=\"token punctuation\">;</span> <span class=\"token number\">196.7500</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">0.001</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>propeller_poinit_new  <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>propeller_RT_B_to_motor<span class=\"token punctuation\">&#123;</span><span class=\"token number\">i</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">*</span><span class=\"token punctuation\">[</span>propeller_poinit<span class=\"token operator\">'</span><span class=\"token punctuation\">;</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>propeller_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>propeller_poinit_new<span class=\"token operator\">=</span><span class=\"token function\">propeller_poinit_new</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>propeller<span class=\"token punctuation\">&#123;</span><span class=\"token number\">i</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>Vertices <span class=\"token operator\">=</span> propeller_poinit_new<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>axis equal</pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token comment\">% axis vis3d</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>box on </pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token function\">camlight</span><span class=\"token punctuation\">(</span>\"headlight\"<span class=\"token punctuation\">)</span><span class=\"token comment\">% 打光</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span>\"x\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"y\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token function\">zlabel</span><span class=\"token punctuation\">(</span>\"z\"<span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://to-pro.github.io/matlab/lesson2/",
            "url": "https://to-pro.github.io/matlab/lesson2/",
            "title": "動畫 lesson 2",
            "date_published": "2024-10-23T09:49:18.110Z",
            "content_html": "<p>這一篇將介紹如何在 MATLAB 中的 Figure 中引入 STL 檔案。</p>\n<p>首先了解 STL 是甚麼可以參考:<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYWRvYmUuY29tL3R3L2NyZWF0aXZlY2xvdWQvZmlsZS10eXBlcy9pbWFnZS92ZWN0b3Ivc3RsLWZpbGUuaHRtbA==\"> 了解 STL 檔案格式</span>。不論是從網路或是使用 Solid work 自己繪製。都可以獲得 STL 檔案的模型。檔案中主要內容是點跟向量。向量表示那些點組成三角形表面。這裡特別建議 STL 檔案中的原點最好在使用前先用程式設定好，用 MATLAB 內建的可以調整與儲存但麻煩許多也不直觀。</p>\n<h3 id=\"成果展示\"><a class=\"anchor\" href=\"#成果展示\">#</a> 成果展示:</h3>\n<p><img data-src=\"https://imgur.com/1stcyjR.jpg\" alt=\"Imgur\" /></p>\n<p>範例的 STL 可以在這邊下載:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2RyaXZlL2ZvbGRlcnMvMUxBbUlWNzFuUTRtaHVQUWxnWm5PNDVGZjBKUEN2Z3Z3P3VzcD1kcml2ZV9saW5r\"> 載點</span></p>\n<h3 id=\"程式碼\"><a class=\"anchor\" href=\"#程式碼\">#</a> 程式碼:</h3>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">% plot stl and animation example </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>clc<span class=\"token punctuation\">;</span>clear<span class=\"token punctuation\">;</span>close all</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">addpath</span><span class=\"token punctuation\">(</span><span class=\"token function\">genpath</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.\\STL\\250'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">% 路徑需要更改</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">% addpath 說明</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">% 1、文件在当前路径下：使用 load ('***.mat')</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">% 2、文件在下一级路径下：使用 load (' .\\ 下一级路径的文件名 \\***.mat ');</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">% 3、文件在上一级路径下：使用 load (' ..\\***.mat ');</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">% 4、文件在平行文件夹内：使用 load (' ..\\ 平行的文件夹 \\***.mat');</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">%%</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>Drone_raw <span class=\"token operator\">=</span> <span class=\"token function\">stlread</span><span class=\"token punctuation\">(</span>\"<span class=\"token number\">250.</span>STL\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>Drone_poinit <span class=\"token operator\">=</span> Drone_raw<span class=\"token punctuation\">.</span>Points<span class=\"token punctuation\">;</span>         <span class=\"token comment\">% 取點</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>Drone_conn <span class=\"token operator\">=</span> Drone_raw<span class=\"token punctuation\">.</span>ConnectivityList<span class=\"token punctuation\">;</span> <span class=\"token comment\">% 取三角形資料</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>point_x<span class=\"token operator\">=</span> <span class=\"token function\">mean</span><span class=\"token punctuation\">(</span><span class=\"token function\">Drone_poinit</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      <span class=\"token comment\">% 置中 (但原點最好前處理解決掉，例如在 SW 中轉 STL 時就設定好重心位置)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">Drone_poinit</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">Drone_poinit</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>point_x<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>Drone_triang <span class=\"token operator\">=</span> <span class=\"token function\">triangulation</span><span class=\"token punctuation\">(</span>Drone_conn<span class=\"token punctuation\">,</span>Drone_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">%stlwrite(F_16_new,\"F_16_new.stl\")</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>Drone <span class=\"token operator\">=</span> <span class=\"token function\">trisurf</span><span class=\"token punctuation\">(</span>Drone_triang<span class=\"token punctuation\">,</span><span class=\"token string\">'facecolor'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'edgecolor'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">% axis equal</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>axis vis3d</pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>box on </pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token function\">camlight</span><span class=\"token punctuation\">(</span>\"headlight\"<span class=\"token punctuation\">)</span><span class=\"token comment\">% 打光</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span>\"x\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"y\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token function\">zlabel</span><span class=\"token punctuation\">(</span>\"z\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\">%% rotate</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>Drone_poinit_new <span class=\"token operator\">=</span> Drone_poinit<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">0.5</span><span class=\"token operator\">:</span><span class=\"token number\">360</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    Drone_position <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token number\">i</span><span class=\"token operator\">/</span><span class=\"token number\">360</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">% 高度升到 0.5 米</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    Drone_dcm <span class=\"token operator\">=</span> <span class=\"token function\">angle2dcm</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">i</span><span class=\"token operator\">/</span><span class=\"token number\">360</span><span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token operator\">*</span><span class=\"token keyword\">pi</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">% 內建的 DCM 會與推導的差一個轉置</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    Drone_RT <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>Drone_dcm<span class=\"token operator\">'</span> Drone_position<span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    Drone_poinit_new  <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Drone_RT<span class=\"token operator\">*</span><span class=\"token punctuation\">[</span>Drone_poinit<span class=\"token operator\">'</span><span class=\"token punctuation\">;</span><span class=\"token function\">ones</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>Drone_poinit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    Drone<span class=\"token punctuation\">.</span>Vertices <span class=\"token operator\">=</span> <span class=\"token function\">Drone_poinit_new</span><span class=\"token punctuation\">(</span><span class=\"token operator\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token function\">zlim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">inf</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    drawnow limitrate</pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://to-pro.github.io/matlab/lesson1/",
            "url": "https://to-pro.github.io/matlab/lesson1/",
            "title": "動畫 lesson 1",
            "date_published": "2024-10-23T09:49:14.589Z",
            "content_html": "<p>本篇以一個簡單的例子說明如何用 MATLAB 函數。繪製目標為將函數 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">sin(2t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 以動畫形式展現。</p>\n<h3 id=\"主要函數介紹\"><a class=\"anchor\" href=\"#主要函數介紹\">#</a> 主要函數介紹:</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvdmlkZW93cml0ZXIuaHRtbA==\">VideoWriter</span>: 建立視訊物件。主要要設定 Quality 和 FrameRate。Quality 是質量基本上設定上限 100。FrameRate 則是幀數，每秒幾張圖須配合寫入做調整。</p>\n<p>簡單舉例:</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>writerObj <span class=\"token operator\">=</span> <span class=\"token function\">VideoWriter</span><span class=\"token punctuation\">(</span>video_name<span class=\"token punctuation\">,</span><span class=\"token string\">'MPEG-4'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>writerObj<span class=\"token punctuation\">.</span>FrameRate <span class=\"token operator\">=</span> <span class=\"token number\">25</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">% 每秒幾張圖</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>writerObj<span class=\"token punctuation\">.</span>Quality <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">% 開始錄製 (用迴圈)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>n</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>%</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">% 更新畫面....</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>%</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>drawnow limitrate<span class=\"token punctuation\">;</span><span class=\"token comment\">% 立即繪製</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">writeVideo</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">,</span><span class=\"token function\">getframe</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">% 結束錄製</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">close</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 一定要關閉才能錄製成功</span></pre></td></tr></table></figure><h3 id=\"成果展示\"><a class=\"anchor\" href=\"#成果展示\">#</a> 成果展示:</h3>\n<p>前後暫停 1 秒。並且時間窗格設定為 5 秒，會跟著當前時間顯示函數。<br />\n<img data-src=\"https://imgur.com/rRLsQDx.jpg\" alt=\"Imgur\" /></p>\n<h3 id=\"程式碼\"><a class=\"anchor\" href=\"#程式碼\">#</a> 程式碼:</h3>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>clc<span class=\"token punctuation\">;</span>clear<span class=\"token punctuation\">;</span>close all<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">%% 生成資料</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>dt <span class=\"token operator\">=</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>t_end <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>t <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span>dt<span class=\"token operator\">:</span>t_end<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>y <span class=\"token operator\">=</span> <span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>video_name <span class=\"token operator\">=</span> <span class=\"token string\">'sin wave'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>time_window <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span><span class=\"token comment\">%Unit:sec</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">%% 繪圖</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>video<span class=\"token operator\">=</span><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">,</span><span class=\"token string\">'Position'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span> <span class=\"token number\">49</span> <span class=\"token number\">1.7067e+03</span> <span class=\"token number\">946</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">% 需放大錄製，不然畫質很差</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>p1 <span class=\"token operator\">=</span> <span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">:</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>\"b\"<span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>\"<span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>circle <span class=\"token operator\">=</span> <span class=\"token function\">plot</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\"Color\"<span class=\"token punctuation\">,</span>\"r\"<span class=\"token punctuation\">,</span>\"LineStyle\"<span class=\"token punctuation\">,</span>\"none\"<span class=\"token punctuation\">,</span>\"Marker\"<span class=\"token punctuation\">,</span>\"o\"<span class=\"token punctuation\">,</span>\"MarkerSize\"<span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>xlim tight</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>ylim padded</pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"$<span class=\"token operator\">\\</span><span class=\"token function\">sin</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span>t<span class=\"token punctuation\">)</span>$\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token function\">Time</span> <span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>grid on <span class=\"token comment\">% 打開網格 </span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>g1 <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>g1<span class=\"token punctuation\">.</span>FontSize <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">% 顯示時間</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>Time_txt<span class=\"token operator\">=</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'String'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token string\">'time: '</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'00.00'</span> <span class=\"token punctuation\">,</span><span class=\"token string\">' s'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>              <span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>              <span class=\"token string\">'FontSize'</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>              <span class=\"token string\">'Units'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'normalized'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>              <span class=\"token string\">'Position'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span> <span class=\"token number\">0.8</span> <span class=\"token number\">1.04</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">%% 錄影設定</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>writerObj <span class=\"token operator\">=</span> <span class=\"token function\">VideoWriter</span><span class=\"token punctuation\">(</span>video_name<span class=\"token punctuation\">,</span><span class=\"token string\">'MPEG-4'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>writerObj<span class=\"token punctuation\">.</span>FrameRate <span class=\"token operator\">=</span> <span class=\"token number\">25</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">% 每秒幾張圖 (如要顯示時間要注意這個設定)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>writerObj<span class=\"token punctuation\">.</span>Quality <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token comment\">%% 起始前暫停影像</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>p1<span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>p1<span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> <span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>circle<span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>p1<span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> <span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>min_y <span class=\"token operator\">=</span> <span class=\"token function\">min</span><span class=\"token punctuation\">(</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>max_y <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>lim_y_offset <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_y<span class=\"token operator\">-</span>min_y<span class=\"token punctuation\">)</span><span class=\"token operator\">></span>lim_y_offset</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    lim_y_offset <span class=\"token operator\">=</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_y<span class=\"token operator\">-</span>min_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>g1<span class=\"token punctuation\">.</span>YLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>min_y<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset max_y<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>g1<span class=\"token punctuation\">.</span>XLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span> time_window<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">25</span> <span class=\"token comment\">% 暫停一秒 </span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>     <span class=\"token function\">writeVideo</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">,</span><span class=\"token function\">getframe</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token comment\">%% 開始錄製</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>ii <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token operator\">*</span><span class=\"token number\">i</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>time <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>p1<span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>p1<span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> <span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>circle<span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>circle<span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> <span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre></pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token comment\">% 檢測顯示線的 Y 方向最大刻度</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>min_y <span class=\"token operator\">=</span> <span class=\"token function\">min</span><span class=\"token punctuation\">(</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>max_y <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>lim_y_offset <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">% 設定最小 Y 軸長度</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_y<span class=\"token operator\">-</span>min_y<span class=\"token punctuation\">)</span><span class=\"token operator\">></span>lim_y_offset</pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    lim_y_offset <span class=\"token operator\">=</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_y<span class=\"token operator\">-</span>min_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>g1<span class=\"token punctuation\">.</span>YLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>min_y<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset max_y<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 設定 Y 軸</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre></pre></td></tr><tr><td data-num=\"80\"></td><td><pre><span class=\"token comment\">% 設定 X 軸</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>time <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.7</span><span class=\"token operator\">*</span>time_window<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    g1<span class=\"token punctuation\">.</span>XLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span> time_window<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    g1<span class=\"token punctuation\">.</span>XLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>time<span class=\"token operator\">-</span><span class=\"token number\">0.7</span><span class=\"token operator\">*</span>time_window time<span class=\"token operator\">+</span><span class=\"token number\">0.3</span><span class=\"token operator\">*</span>time_window<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token comment\">% 文字更新</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>Time_txt<span class=\"token punctuation\">.</span>String<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'time: '</span><span class=\"token punctuation\">,</span> <span class=\"token function\">num2str</span><span class=\"token punctuation\">(</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'%5.2f'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span><span class=\"token string\">' s'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>drawnow limitrate<span class=\"token punctuation\">;</span><span class=\"token comment\">% 立即繪製</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre><span class=\"token function\">writeVideo</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">,</span><span class=\"token function\">getframe</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre></pre></td></tr><tr><td data-num=\"94\"></td><td><pre><span class=\"token comment\">%% 最後暫停畫面 (主要是讓時間可以顯示整數)</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre><span class=\"token comment\">% 子圖更新</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>ii <span class=\"token operator\">=</span> <span class=\"token function\">length</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>time <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>p1<span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>p1<span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> <span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>circle<span class=\"token punctuation\">.</span>XData <span class=\"token operator\">=</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>circle<span class=\"token punctuation\">.</span>YData <span class=\"token operator\">=</span> <span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre></pre></td></tr><tr><td data-num=\"104\"></td><td><pre></pre></td></tr><tr><td data-num=\"105\"></td><td><pre><span class=\"token comment\">% 檢測顯示線的 Y 方向最大刻度</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>min_y <span class=\"token operator\">=</span> <span class=\"token function\">min</span><span class=\"token punctuation\">(</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>max_y <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>lim_y_offset <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">% 設定最小 Y 軸長度</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_y<span class=\"token operator\">-</span>min_y<span class=\"token punctuation\">)</span><span class=\"token operator\">></span>lim_y_offset</pre></td></tr><tr><td data-num=\"110\"></td><td><pre>    lim_y_offset <span class=\"token operator\">=</span> <span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>max_y<span class=\"token operator\">-</span>min_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>g1<span class=\"token punctuation\">.</span>YLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>min_y<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset max_y<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token operator\">*</span>lim_y_offset<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 設定 Y 軸</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre></pre></td></tr><tr><td data-num=\"114\"></td><td><pre><span class=\"token comment\">% 設定 X 軸</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>time <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.7</span><span class=\"token operator\">*</span>time_window<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>    g1<span class=\"token punctuation\">.</span>XLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span> time_window<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>    g1<span class=\"token punctuation\">.</span>XLim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>time<span class=\"token operator\">-</span><span class=\"token number\">0.7</span><span class=\"token operator\">*</span>time_window time<span class=\"token operator\">+</span><span class=\"token number\">0.3</span><span class=\"token operator\">*</span>time_window<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre></pre></td></tr><tr><td data-num=\"121\"></td><td><pre><span class=\"token comment\">% 文字更新</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>Time_txt<span class=\"token punctuation\">.</span>String<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'time: '</span><span class=\"token punctuation\">,</span> <span class=\"token function\">num2str</span><span class=\"token punctuation\">(</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span>ii<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'%5.2f'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span><span class=\"token string\">' s'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">25</span> <span class=\"token comment\">% 結束暫停影像 (一秒)</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>    <span class=\"token function\">writeVideo</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">,</span><span class=\"token function\">getframe</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre><span class=\"token function\">close</span><span class=\"token punctuation\">(</span>writerObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 一定要關閉才能錄製成功</span></pre></td></tr></table></figure><h3 id=\"回家作業\"><a class=\"anchor\" href=\"#回家作業\">#</a> 回家作業</h3>\n<p>配合前一份旋轉方塊的程式碼，可以用它展示姿態變化。</p>\n",
            "tags": []
        },
        {
            "id": "https://to-pro.github.io/matlab/note_part2/",
            "url": "https://to-pro.github.io/matlab/note_part2/",
            "title": "Matlab figure 筆記2",
            "date_published": "2023-03-21T03:53:08.909Z",
            "content_html": "<h3 id=\"示範在空間中畫一個方塊-並運用方向餘弦矩陣dcm畫不同姿態的方塊\"><a class=\"anchor\" href=\"#示範在空間中畫一個方塊-並運用方向餘弦矩陣dcm畫不同姿態的方塊\">#</a> 示範在空間中畫一個方塊。並運用方向餘弦矩陣 (DCM)，畫不同姿態的方塊</h3>\n<p>重點函數說明:<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvcGF0Y2guaHRtbA==\">patch</span> 畫方塊</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvcXVpdmVyMy5odG1s\">quiver3</span> 畫箭頭</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL2Flcm90YngvdWcvYW5nbGUyZGNtLmh0bWw=\">angle2dcm</span> 產生方向餘弦矩陣來旋轉方塊 (預設為 (yaw,pitch,roll))</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvZHJhd25vdy5odG1s\">drawnow</span> 更新 figure</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>clc<span class=\"token punctuation\">;</span>clear<span class=\"token punctuation\">;</span>close all<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token function\">figure</span><span class=\"token punctuation\">(</span>\"Name\"<span class=\"token punctuation\">,</span>\"cube\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>vertices <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">0.5</span> <span class=\"token operator\">-</span><span class=\"token number\">0.5</span> <span class=\"token operator\">-</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>             <span class=\"token number\">0.5</span> <span class=\"token operator\">-</span><span class=\"token number\">0.5</span> <span class=\"token operator\">-</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>             <span class=\"token number\">0.5</span>  <span class=\"token number\">0.5</span> <span class=\"token operator\">-</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token operator\">-</span><span class=\"token number\">0.5</span>  <span class=\"token number\">0.5</span> <span class=\"token operator\">-</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token operator\">-</span><span class=\"token number\">0.5</span> <span class=\"token operator\">-</span><span class=\"token number\">0.5</span>  <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>             <span class=\"token number\">0.5</span> <span class=\"token operator\">-</span><span class=\"token number\">0.5</span>  <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>             <span class=\"token number\">0.5</span>  <span class=\"token number\">0.5</span>  <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token operator\">-</span><span class=\"token number\">0.5</span>  <span class=\"token number\">0.5</span>  <span class=\"token number\">0.5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 正方體有八個頂點</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>faces <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span> <span class=\"token number\">2</span> <span class=\"token number\">6</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span><span class=\"token number\">2</span> <span class=\"token number\">3</span> <span class=\"token number\">7</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span><span class=\"token number\">3</span> <span class=\"token number\">4</span> <span class=\"token number\">8</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span><span class=\"token number\">4</span> <span class=\"token number\">1</span> <span class=\"token number\">5</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span><span class=\"token number\">1</span> <span class=\"token number\">2</span> <span class=\"token number\">3</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span><span class=\"token number\">5</span> <span class=\"token number\">6</span> <span class=\"token number\">7</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 其 6 個面的頂點，點的順序根據 vertices</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>cube <span class=\"token operator\">=</span> <span class=\"token function\">patch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Vertices'</span><span class=\"token punctuation\">,</span>vertices<span class=\"token punctuation\">,</span><span class=\"token string\">'Faces'</span><span class=\"token punctuation\">,</span>faces<span class=\"token punctuation\">,</span><span class=\"token string\">'Facecolor'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>Vx_ini <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>Vy_ini <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>Vz_ini <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>Vx <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>Vy <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>Vz <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>Xaxis <span class=\"token operator\">=</span> <span class=\"token function\">quiver3</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token function\">Vx</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">Vx</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">Vx</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">,</span><span class=\"token string\">'r'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'filled'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Linewidth'</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>Yaxis <span class=\"token operator\">=</span> <span class=\"token function\">quiver3</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token function\">Vy</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">Vy</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">Vy</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">,</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'filled'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Linewidth'</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>Zaxis <span class=\"token operator\">=</span> <span class=\"token function\">quiver3</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token function\">Vz</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">Vz</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">Vz</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">,</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'filled'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Linewidth'</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>ax<span class=\"token operator\">=</span>gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>ax<span class=\"token punctuation\">.</span>FontSize <span class=\"token operator\">=</span> <span class=\"token number\">14</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>ax<span class=\"token punctuation\">.</span>FontName <span class=\"token operator\">=</span> <span class=\"token string\">'Times New Roman'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>grid on <span class=\"token comment\">% 開網格</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token function\">view</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">%3D 來看</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>axis equal  <span class=\"token comment\">% 沿每個軸對數據單位使用相同的長度。</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token function\">axis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1.5</span> <span class=\"token number\">2.2</span> <span class=\"token operator\">-</span><span class=\"token number\">1.5</span> <span class=\"token number\">2.2</span> <span class=\"token operator\">-</span><span class=\"token number\">1.5</span> <span class=\"token number\">2.2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span>n</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>dcm <span class=\"token operator\">=</span> <span class=\"token function\">angle2dcm</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">pi</span><span class=\"token operator\">/</span><span class=\"token number\">4</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 旋轉餘弦矩陣 (與筆者常用的差一個轉置)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>cube<span class=\"token punctuation\">.</span>Vertices <span class=\"token operator\">=</span> vertices<span class=\"token operator\">*</span>dcm<span class=\"token operator\">'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>Vx<span class=\"token operator\">=</span>dcm<span class=\"token operator\">'</span><span class=\"token operator\">*</span>Vx_ini<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>Vy<span class=\"token operator\">=</span>dcm<span class=\"token operator\">'</span><span class=\"token operator\">*</span>Vy_ini<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>Vz<span class=\"token operator\">=</span>dcm<span class=\"token operator\">'</span><span class=\"token operator\">*</span>Vz_ini<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>Xaxis<span class=\"token punctuation\">.</span>UData<span class=\"token operator\">=</span><span class=\"token function\">Vx</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>Xaxis<span class=\"token punctuation\">.</span>VData<span class=\"token operator\">=</span><span class=\"token function\">Vx</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>Xaxis<span class=\"token punctuation\">.</span>WData<span class=\"token operator\">=</span><span class=\"token function\">Vx</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>Yaxis<span class=\"token punctuation\">.</span>UData<span class=\"token operator\">=</span><span class=\"token function\">Vy</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>Yaxis<span class=\"token punctuation\">.</span>VData<span class=\"token operator\">=</span><span class=\"token function\">Vy</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>Yaxis<span class=\"token punctuation\">.</span>WData<span class=\"token operator\">=</span><span class=\"token function\">Vy</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>Zaxis<span class=\"token punctuation\">.</span>UData<span class=\"token operator\">=</span><span class=\"token function\">Vz</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>Zaxis<span class=\"token punctuation\">.</span>VData<span class=\"token operator\">=</span><span class=\"token function\">Vz</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>Zaxis<span class=\"token punctuation\">.</span>WData<span class=\"token operator\">=</span><span class=\"token function\">Vz</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>drawnow<span class=\"token punctuation\">;</span><span class=\"token comment\">% 以新的姿態重新繪製方塊</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token operator\">&lt;</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token function\">fprintf</span><span class=\"token punctuation\">(</span>\"Press any key to <span class=\"token keyword\">continue</span><span class=\"token operator\">.\\</span>n\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">pause</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 暫停直到按任意鍵</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token function\">fprintf</span><span class=\"token punctuation\">(</span>\"Rotation display ends<span class=\"token operator\">.\\</span>n\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr></table></figure><p>圖:<br />\n<img data-src=\"https://imgur.com/dTdj4Zz.jpg\" alt=\"Imgur\" /></p>\n",
            "tags": []
        },
        {
            "id": "https://to-pro.github.io/matlab/note_part1/",
            "url": "https://to-pro.github.io/matlab/note_part1/",
            "title": "Matlab figure 筆記1",
            "date_published": "2023-03-21T03:53:08.899Z",
            "content_html": "<h2 id=\"繪圖的精神為清晰明顯的表達所有資訊\"><a class=\"anchor\" href=\"#繪圖的精神為清晰明顯的表達所有資訊\">#</a> 繪圖的精神為清晰明顯的表達所有資訊</h2>\n<p>此次所用資料生成<br />\n假設有如下生成的資料需要繪圖</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>clc<span class=\"token punctuation\">;</span>clear<span class=\"token punctuation\">;</span>close all<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>addpath <span class=\"token string\">'Z:\\My Drive\\matlab\\plot_function'</span><span class=\"token comment\">% 本人自訂函數存放處</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>dt <span class=\"token operator\">=</span> <span class=\"token number\">0.001</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>t_end <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>t <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span>dt<span class=\"token operator\">:</span>t_end<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>theta <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span><span class=\"token function\">exp</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">exp</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.6</span><span class=\"token operator\">*</span>t<span class=\"token punctuation\">)</span><span class=\"token operator\">.*</span><span class=\"token number\">0.1</span><span class=\"token operator\">.*</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token operator\">*</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>noise <span class=\"token operator\">=</span> <span class=\"token number\">0.01</span><span class=\"token operator\">*</span><span class=\"token function\">randn</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>theta_m <span class=\"token operator\">=</span> theta <span class=\"token operator\">+</span> noise<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"基本的繪圖\"><a class=\"anchor\" href=\"#基本的繪圖\">#</a> 基本的繪圖</h2>\n<p>基本上繪圖要有</p>\n<blockquote>\n<p>X 座標 (含單位)<br />\n Y 座標 (含單位)<br />\n 圖例 (當此圖有多條線時)<br />\n 標題 (可有可無，可在報告中的標號時說明)</p>\n</blockquote>\n<p>其中 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvcGxvdC5odG1s\">plot</span> (建議多參考官網的說明) 有幾個重要屬性基本都要調整使其繪的圖可以清晰，<mark>LineStyle</mark>、<mark>Color</mark> 和<mark> LineWidth</mark>。<br />\n以下示範簡單繪製<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span> 與<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\theta_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 在同一張圖。因為<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\theta_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 含有噪音，要優先畫才不會蓋到<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span>\"Name\"<span class=\"token punctuation\">,</span>\"state\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>r\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>b\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span>\"<span class=\"token operator\">\\</span>theta\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">\\</span>theta_m\"<span class=\"token punctuation\">)</span><span class=\"token comment\">% 圖例</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token function\">Time</span> <span class=\"token punctuation\">(</span>sec<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% X 座標名稱</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token operator\">\\</span><span class=\"token function\">theta</span> <span class=\"token punctuation\">(</span>rad<span class=\"token operator\">/</span>s<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% Y 座標名稱</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">title</span><span class=\"token punctuation\">(</span>\"Response\"<span class=\"token punctuation\">)</span><span class=\"token comment\">% 標題</span></pre></td></tr></table></figure><p><img data-src=\"https://i.imgur.com/wjzXxqV.png\" alt=\"img\" /><br />\n 此程式碼繪的圖有幾個問題</p>\n<blockquote>\n<p>線粗細可以在粗一些<br />\n圖例擋到線<br />\n字太小 (這要根據你最終要放到的報告中調整，簡單來說要與報告內文相同)<br />\n 不知道最終值是不是在 1 附近</p>\n</blockquote>\n<h2 id=\"高級的繪圖\"><a class=\"anchor\" href=\"#高級的繪圖\">#</a> 高級的繪圖</h2>\n<p>除了剛剛的缺點，這裡還更改了圖例顯示的順序，用物件接住 plot，在對此物件標示圖例，此法可以延伸應用到僅標示要標示的線 (參考雙 Y 軸圖的程式碼)</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'response'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span><span class=\"token string\">'-r'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'LineWidth'</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span><span class=\"token string\">'-b'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'LineWidth'</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta_m'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'location'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'southeast'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% X 座標名稱</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\theta (rad/s)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% Y 座標名稱</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Response'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">% 標題</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>ax <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'FontSize'</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'FontName'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Times New Roman'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'XGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'YGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>ax<span class=\"token punctuation\">.</span>TitleFontSizeMultiplier<span class=\"token operator\">=</span><span class=\"token number\">1.3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'XMinorGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'YMinorGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"https://imgur.com/BVXeQTb.png\" alt=\"img\" /><br />\n 小提示：每個東西都有很多屬性可以設定。令一個變數接住，並且後面不加分號。你就能在 Command Window 看到新世界 (有很多屬性可以調整)。將上面程式碼中的 legend 改成像這樣</p>\n<pre><code>l = legend(p,'\\theta_m','\\theta')\n</code></pre>\n<h2 id=\"繪圖函數設定\"><a class=\"anchor\" href=\"#繪圖函數設定\">#</a> 繪圖函數設定</h2>\n<p>因為每張圖都有類似的共同的設定，因此將其包成函數，以後畫圖就很輕鬆，這是我常用的繪圖設定函數</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span>varargin<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>nInputs <span class=\"token operator\">=</span> nargin<span class=\"token punctuation\">;</span><span class=\"token comment\">% 偵測輸入有幾個變數</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span> nInputs <span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token comment\">% 若只有一個變數就是字體大小的設定值</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    ax_FontSize <span class=\"token operator\">=</span> varargin<span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    ax_FontSize <span class=\"token operator\">=</span> varargin<span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 字體大小的設定值</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    Line_width <span class=\"token operator\">=</span> varargin<span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 所有 plot 的線粗細設定值</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>ax <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span><span class=\"token comment\">% 當前座標區或圖</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'FontSize'</span><span class=\"token punctuation\">,</span>ax_FontSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 字體大小設定</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'FontName'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Times New Roman'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 字體設定</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'XGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'YGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 開網格</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'XMinorGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'YMinorGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 開更密的網格</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>ax<span class=\"token punctuation\">.</span>TitleFontSizeMultiplier<span class=\"token operator\">=</span><span class=\"token number\">1.3</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 標題與一般文字大小的放大倍率</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">% 所有 plot 的線粗細設定</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">if</span> nInputs <span class=\"token operator\">==</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>plot_num <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">.</span>Children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% ax.Children 就是 figure 裡 plot 的線</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> plot_num</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">%     ax.Children (i).LineStyle = '-';% 統一線的樣式 (通常多條線就要不一樣)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    ax<span class=\"token punctuation\">.</span><span class=\"token function\">Children</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>LineWidth <span class=\"token operator\">=</span> Line_width<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr></table></figure><p>則使用以下程式碼就能畫出相同的圖</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span>\"Name\"<span class=\"token punctuation\">,</span>\"state\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>r\"<span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>b\"<span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span>\"<span class=\"token operator\">\\</span>theta_m\" \"<span class=\"token operator\">\\</span>theta\"<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\"location\"<span class=\"token punctuation\">,</span>\"best\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token function\">Time</span> <span class=\"token punctuation\">(</span>sec<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% X 座標名稱</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token operator\">\\</span><span class=\"token function\">theta</span> <span class=\"token punctuation\">(</span>rad<span class=\"token operator\">/</span>s<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% Y 座標名稱</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">title</span><span class=\"token punctuation\">(</span>\"Response\"<span class=\"token punctuation\">)</span><span class=\"token comment\">% 標題</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"子母圖\"><a class=\"anchor\" href=\"#子母圖\">#</a> 子母圖</h2>\n<p>有時需要放大圖中某個地方等需求，就可以這樣畫<br />\n<img data-src=\"https://imgur.com/Yguh8h3.png\" alt=\"Imgur\" /><br />\n 程式碼如下</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>ab</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'response'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span><span class=\"token string\">'-r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span><span class=\"token string\">'-b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta_m'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'location'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'southeast'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% X 座標名稱</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\theta (rad/s)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% Y 座標名稱</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Response'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">% 標題</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">axes</span><span class=\"token punctuation\">(</span><span class=\"token string\">'position'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.45</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.40</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">% 子圖位置與大小 [距圖左邊距離 距圖下邊距離 子圖寬 子圖高]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span><span class=\"token string\">'-r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span><span class=\"token string\">'-b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">axis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span> <span class=\"token number\">10</span> <span class=\"token operator\">-</span><span class=\"token keyword\">inf</span> <span class=\"token keyword\">inf</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>ylim <span class=\"token string\">'padded'</span><span class=\"token comment\">% padded 為邊距的寬度約為數據范圍的 7%</span></pre></td></tr></table></figure><h2 id=\"雙y軸圖\"><a class=\"anchor\" href=\"#雙y軸圖\">#</a> 雙 Y 軸圖</h2>\n<p>有時要繪製在一起的資料量級相差太大，但又想繪製在一起觀察，就可以考慮有效利用兩邊 Y 軸來繪圖<br />\n<img data-src=\"https://imgur.com/pZHZdZi.png\" alt=\"Imgur\" /></p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>ab</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'All'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span><span class=\"token string\">'-r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span><span class=\"token string\">'-b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% X 座標名稱</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\theta (rad/s)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 左邊 Y 座標名稱</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Response'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">% 標題</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>yyaxis right <span class=\"token comment\">% 改右邊 Y 軸來畫</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>input<span class=\"token punctuation\">,</span><span class=\"token string\">'-m'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'voltage (V)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Color'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 右邊 Y 座標名稱</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>ax <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>ax<span class=\"token punctuation\">.</span>YColor<span class=\"token operator\">=</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta_m'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'location'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>ylim <span class=\"token string\">'padded'</span><span class=\"token comment\">% padded 為邊距的寬度約為數據范圍的 7%</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9tYXRsYWJjZW50cmFsL2Fuc3dlcnMvMTY2MTI5NS1ob3ctdG8tc2V0LWZyb250LWFuZC1iYWNrLWxpbmVzLW9uLXBsb3Qtd2l0aC15eWF4aXMtbGVmdC1hbmQtcmlnaHQ=\">前後問題改起來很麻煩可以參考這裡解決</span></p>\n<h2 id=\"用迴圈存圖\"><a class=\"anchor\" href=\"#用迴圈存圖\">#</a> 用迴圈存圖</h2>\n<p>最後耍帥的用程式碼將全部圖片存到指定地點，後續可用 Latex 自動讀檔製作報告，使用函數<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvcHJpbnQuaHRtbA==\"> print</span></p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'theta'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span><span class=\"token string\">'-b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'voltage (V)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">end</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'theta_m'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span><span class=\"token string\">'-r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'voltage (V)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">end</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>input<span class=\"token punctuation\">,</span><span class=\"token string\">'-m'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'voltage (V)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>fig<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>     <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Z:\\My Drive\\matlab\\example\\Figure\\'</span> <span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-depsc'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr></table></figure><p>備註：這裡設定 -depsc 是存成向量檔 (.eps)，放大才不會有像素感。</p>\n",
            "tags": []
        }
    ]
}