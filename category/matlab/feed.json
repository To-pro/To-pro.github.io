{
    "version": "https://jsonfeed.org/version/1",
    "title": "Chih Chia's Blog • All posts by \"matlab\" category",
    "description": "",
    "home_page_url": "https://to-pro.github.io",
    "items": [
        {
            "id": "https://to-pro.github.io/matlab/lesson4/",
            "url": "https://to-pro.github.io/matlab/lesson4/",
            "title": "動畫 lesson 4",
            "date_published": "2024-10-23T09:49:20.501Z",
            "content_html": "<p>結合前面的介紹，我們可以將無人機飛行模擬結果繪製成動畫。</p>\n<p>範例中的 MAT 檔 (auto_fly_90.mat) 裡面有兩個結構變數分別是飛行資料 data 和期望軌跡 desired_trajectory</p>\n<ul>\n<li>\n<p>data:</p>\n<ul>\n<li>t: 時間</li>\n<li>x: 無人機 x 位置</li>\n<li>y: 無人機 y 位置</li>\n<li>z: 無人機 z 位置</li>\n<li>P:[x;y;z] 無人機位置</li>\n<li>phi,theta,psi: 無人機姿態</li>\n</ul>\n</li>\n<li>\n<p>desired_trajectory:</p>\n<ul>\n<li>waypoint: 航點</li>\n<li>x_d: 無人機期望 x 位置</li>\n<li>y_d: 無人機期望 y 位置</li>\n<li>z_d: 無人機期望 z 位置</li>\n<li>phi_d,theta_d,psi_d: 無人機期望姿態</li>\n<li>p: 小圖期望位置</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"成果展示\"><a class=\"anchor\" href=\"#成果展示\">#</a> 成果展示:</h3>\n<p><img data-src=\"lesson4.png\" alt=\"alt text\" /></p>\n<p>範例的 STL 與 MAT 可以在這邊下載:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2RyaXZlL2ZvbGRlcnMvMUxBbUlWNzFuUTRtaHVQUWxnWm5PNDVGZjBKUEN2Z3Z3P3VzcD1kcml2ZV9saW5r\"> 載點</span></p>\n<h3 id=\"程式碼\"><a class=\"anchor\" href=\"#程式碼\">#</a> 程式碼:</h3>\n<pre><code class=\"language-MATLAB\">%全地圖畫法\nclc;clear;close all;\n\naddpath 'Z:\\My Drive\\MATLAB\\plot_function'\naddpath(genpath('.\\STL\\450'))\n\nload auto_fly_90.mat;\n\nvideo_name='auto_fly_90';\n\n%使用者設定開始\n\nfuselage_color = [0.9,0.9,0.8];\npropeller_color = [0 0 0];\ndata_color = 'b';\nstl_amplification = 0.5;\n\nreference_color = 'g';\nwaypoint_color = 'r';\ntime_window = 8;%sec\n\n%使用者設定結束\n\n%% 繪製動畫準備\nvideo=figure();\nset(video,'Position',[1 49 1.7067e+03 946],'color','w');%需放大錄製，不然畫質很差\n\nsubplot('Position', [0.06,0.035,0.7,0.95]);\ng_main = gca;\nhold on\n\n%透明球(避免邊界隨螺旋槳變化)\n[bal.x,bal.y,bal.z] = sphere;\nbal.x = bal.x*0.5*stl_amplification;\nbal.y = bal.y*0.5*stl_amplification;\nbal.z = bal.z*0.5*stl_amplification;\nball = surf(bal.x,bal.y,bal.z,&quot;FaceAlpha&quot;,0,&quot;LineStyle&quot;,&quot;none&quot;);\n\n\n%機架\nF450_raw = stlread(&quot;F450_no_propeller.stl&quot;);\nF450_poinit = stl_amplification*F450_raw.Points;           %取點\nF450_conn = F450_raw.ConnectivityList;   %取三角形\nclear F450_raw;\nF450_triang = triangulation(F450_conn,F450_poinit);\nF450 = trisurf(F450_triang,'facecolor',fuselage_color,'edgecolor','none');\nhold on\n\n%槳葉\npropeller_raw = stlread(&quot;propeller.stl&quot;);\npropeller_poinit = stl_amplification*propeller_raw.Points;           %取點\npropeller_conn = propeller_raw.ConnectivityList;   %取三角形\nclear propeller_raw;\npropeller_triang = triangulation(propeller_conn,propeller_poinit);\n\nfor i=1:4\n    propeller&#123;i&#125; = trisurf(propeller_triang,'facecolor',propeller_color,'edgecolor','none');\nend\npropeller_RT_B_to_motor = cell(4,1);\npropeller_deg = [pi*0.1;pi*0.2;pi*0.3;pi*0.4];\n\n\n\n%% 開燈\ncamlight(&quot;headlight&quot;)\n\n\n%% 文字設定\ndigits_set='%5.2f';\n\nTime_txt=text('String',['time: ', '00.00' ,' s'],...\n              'Interpreter','latex',...\n              'FontSize',30,...\n              'Units','normalized',...\n              'Position',[ 0.05 0.95 0]);\n\n% t = data.t(1:3000);\nt = data.t;\ndt = t(2)-t(1);\n\n%% 初始狀態\n%透明球\nball.XData = bal.x + data.P(1,1);\nball.YData = bal.y + data.P(2,1);\nball.ZData = bal.z + data.P(3,1);\n\n%機架\nF450_dcm = angle2dcm (data.psi(1),data.theta(1),data.phi(1));\nF450_RT = [F450_dcm',data.P(:,1);[0,0,0,1]];\nF450_F450_poinit_new  = (F450_RT*[F450_poinit';ones(1,length(F450_poinit))])';\nF450_F450_poinit_new=F450_F450_poinit_new(:,1:3);\nF450.Vertices = F450_F450_poinit_new;\n\n%槳葉\npropeller_offset&#123;1&#125; = [ 159.1;  159.1; 196.7500]*0.001*stl_amplification;\npropeller_offset&#123;2&#125; = [-159.1;  159.1; 196.7500]*0.001*stl_amplification;\npropeller_offset&#123;3&#125; = [-159.1; -159.1; 196.7500]*0.001*stl_amplification;\npropeller_offset&#123;4&#125; = [ 159.1; -159.1; 196.7500]*0.001*stl_amplification;\n\n\n\nfor i=1:4\n    propeller_RT_B_to_motor&#123;i&#125; = [angle2dcm(propeller_deg(i),0,0)' propeller_offset&#123;i&#125;;[0,0,0,1]];\n    propeller_F450_poinit_new  = (F450_RT*propeller_RT_B_to_motor&#123;i&#125;*[propeller_poinit';ones(1,length(propeller_poinit))])';\n    propeller_F450_poinit_new=propeller_F450_poinit_new(:,1:3);\n    propeller&#123;i&#125;.Vertices = propeller_F450_poinit_new;\nend\n\n\n%% 全部的軌跡\ndata_Trajectory_point=[ones(1,length(t))*data.P(1,1);ones(1,length(t))*data.P(2,1);ones(1,length(t))*data.P(3,1)];\ndata_Trajectory=plot3(data_Trajectory_point(1,:),data_Trajectory_point(2,:),data_Trajectory_point(3,:), ...\n    '-o','MarkerSize',5,'MarkerFaceColor',data_color ...\n    ,'MarkerEdgeColor','none',&quot;LineWidth&quot;,2,'Color',data_color,'MarkerIndices',1:10:length(t));\n\n\n\n%% 航點與期望軌跡\n\nhold on\np(2)=plot3(desired_trajectory.p(1,:),desired_trajectory.p(2,:),desired_trajectory.p(3,:),'-',&quot;Color&quot;,reference_color,&quot;LineWidth&quot;,1.5);\nhold on\nplot3(desired_trajectory.waypoint(1,1:end),desired_trajectory.waypoint(2,1:end),desired_trajectory.waypoint(3,1:end),&quot;Color&quot;,waypoint_color,'LineStyle','-.',&quot;LineWidth&quot;,1.5);\nhold on\nplot3(desired_trajectory.waypoint(1,1),desired_trajectory.waypoint(2,1),desired_trajectory.waypoint(3,1),'o',&quot;Color&quot;,reference_color,'LineStyle','none',&quot;LineWidth&quot;,2);\nhold on\np(1)=plot3(desired_trajectory.waypoint(1,2:end),desired_trajectory.waypoint(2,2:end),desired_trajectory.waypoint(3,2:end),'o',&quot;Color&quot;,waypoint_color,'LineStyle','none',&quot;LineWidth&quot;,2);\n\nlegend([p data_Trajectory],'Waypoint','Desired trajectory','Cascade PID','Location',[0.5955 0.9003 0.1107 0.0751])\n\nxlabel(&quot;X(m)&quot;);\nylabel(&quot;Y(m)&quot;);\nzlabel(&quot;Z(m)&quot;);\n\n\n% axis equal;\naxis padded\ngrid on;\nview(3)\nplot_set(16);\n\n\nwriterObj = VideoWriter(video_name,'MPEG-4');\nwriterObj.FrameRate = 25;\nwriterObj.Quality = 100;\nopen(writerObj);\nn = length(t);\n\n\n%% 其他子圖\nRAD2DEG = 180/pi; \np_y = [data.x;\n       data.y;\n       data.z;\n       RAD2DEG*data.phi;\n       RAD2DEG*data.theta;\n       RAD2DEG*data.psi];\n\nsubplot(&quot;Position&quot;,[0.78 0.82 0.2 0.13]);\np(1) = plot(t,p_y(1,:),&quot;Color&quot;,data_color,&quot;LineStyle&quot;,&quot;-&quot;);\nhold on\nplot(t,desired_trajectory.p(1,:),&quot;LineStyle&quot;,&quot;--&quot;,&quot;Color&quot;,reference_color);\nset(gca,'xticklabel',[])\ng(1) = gca;\nylabel(&quot;$x$ (m)&quot;,&quot;Interpreter&quot;,&quot;latex&quot;);\nplot_set(16,2);\n\nsubplot(&quot;Position&quot;,[0.78 0.67 0.2 0.13]);\np(2) = plot(t,p_y(2,:),&quot;Color&quot;,data_color,&quot;LineStyle&quot;,&quot;-&quot;);\nhold on\nplot(t,desired_trajectory.p(2,:),&quot;LineStyle&quot;,&quot;--&quot;,&quot;Color&quot;,reference_color);\nset(gca,'xticklabel',[])\ng(2) = gca;\nylabel(&quot;$y$ (m)&quot;,&quot;Interpreter&quot;,&quot;latex&quot;);\nplot_set(16,2);\n\nsubplot(&quot;Position&quot;,[0.78 0.52 0.2 0.13]);\np(3) = plot(t,p_y(3,:),&quot;Color&quot;,data_color,&quot;LineStyle&quot;,&quot;-&quot;);\nhold on\nplot(t,desired_trajectory.p(3,:),&quot;LineStyle&quot;,&quot;--&quot;,&quot;Color&quot;,reference_color);\nset(gca,'xticklabel',[])\ng(3) = gca;\nylabel(&quot;$z$ (m)&quot;,&quot;Interpreter&quot;,&quot;latex&quot;);\nplot_set(16,2);\n\nsubplot(&quot;Position&quot;,[0.78 0.37 0.2 0.13]);\np(4) = plot(t,p_y(4,:),'Color',data_color,&quot;LineStyle&quot;,&quot;-&quot;);\nset(gca,'xticklabel',[])\ng(4) = gca;\nylabel(&quot;$\\phi$ ($^&#123;\\circ&#125;$)&quot;,&quot;Interpreter&quot;,&quot;latex&quot;);\nplot_set(16,2);\n\nsubplot(&quot;Position&quot;,[0.78 0.22 0.2 0.13]);\np(5) = plot(t,p_y(5,:),'Color',data_color,&quot;LineStyle&quot;,&quot;-&quot;);\nset(gca,'xticklabel',[])\ng(5) = gca;\nylabel(&quot;$\\theta$ ($^&#123;\\circ&#125;$)&quot;,&quot;Interpreter&quot;,&quot;latex&quot;);\nplot_set(16,2);\n\nsubplot(&quot;Position&quot;,[0.78 0.07 0.2 0.13]);\np(6) = plot(t,p_y(6,:),'Color',data_color,&quot;LineStyle&quot;,&quot;-&quot;);\nhold on\nplot(t,RAD2DEG*desired_trajectory.psi_d(1,:),&quot;LineStyle&quot;,&quot;--&quot;,&quot;Color&quot;,reference_color);\nylabel(&quot;$\\psi$ ($^&#123;\\circ&#125;$)&quot;,&quot;Interpreter&quot;,&quot;latex&quot;);\nxlabel(&quot;Time (s)&quot;,&quot;Interpreter&quot;,&quot;latex&quot;);\ng(6) = gca;\nplot_set(16,2);\n\n\nfor j=1:6\n    time = t(1);\n    p(j).XData = time;\n    p(j).YData = p_y(j,1);\n    min_p_y = min(p_y(j,1:4));\n    max_p_y = max(p_y(j,1:4));\n    lim_y_offset = 10;\n    if abs(max_p_y-min_p_y)&gt;lim_y_offset\n        lim_y_offset = abs(max_p_y-min_p_y);\n    end\n    g(j).YLim=[min_p_y-0.05*lim_y_offset max_p_y+0.05*lim_y_offset];\n\n    if (time &lt; 0.7*time_window)\n        g(j).XLim=[0 time_window];\n    else\n        g(j).XLim=[time-0.7*time_window time+0.3*time_window];\n    end\nend\n%% 繪製動畫準備結束\n\n%% 起始前暫停影像\nfor i=1:25\n     writeVideo(writerObj,getframe(video));\nend\n%%%\n\n%% 開始錄製\nfor i = 1:n/4\nii=4*i;\n%透明球\nball.XData = bal.x + data.P(1,ii);\nball.YData = bal.y + data.P(2,ii);\nball.ZData = bal.z + data.P(3,ii);\n\n%機架\nF450_dcm = angle2dcm (data.psi(ii),data.theta(ii),data.phi(ii));\nF450_RT = [F450_dcm',data.P(:,ii);[0,0,0,1]];\nF450_F450_poinit_new  = (F450_RT*[F450_poinit';ones(1,length(F450_poinit))])';\nF450_F450_poinit_new=F450_F450_poinit_new(:,1:3);\nF450.Vertices = F450_F450_poinit_new;\n\n%槳葉\n\nfor j=1:4\n    propeller_deg(j) = propeller_deg(j) + (-1)^(j)*0.3*pi;\n    propeller_RT_B_to_motor&#123;j&#125; = [angle2dcm(propeller_deg(j),0,0)' propeller_offset&#123;j&#125;;[0,0,0,1]];\n    propeller_F450_poinit_new  = (F450_RT*propeller_RT_B_to_motor&#123;j&#125;*[propeller_poinit';ones(1,length(propeller_poinit))])';\n    propeller_F450_poinit_new=propeller_F450_poinit_new(:,1:3);\n    propeller&#123;j&#125;.Vertices = propeller_F450_poinit_new;\nend\n\ndata_Trajectory.XData(1,i:end)=data.P(1,ii);\ndata_Trajectory.YData(1,i:end)=data.P(2,ii);\ndata_Trajectory.ZData(1,i:end)=data.P(3,ii);\n\n% 子圖更新\ntime = t(ii);\nfor j=1:6\n    \n    if (time &lt; 0.7*time_window)\n        p(j).XData = t(1:ii);\n        p(j).YData = p_y(j,1:ii);\n        min_p_y = min(p_y(j,1:ii));\n        max_p_y = max(p_y(j,1:ii));\n        lim_y_offset = 10;\n        if abs(max_p_y-min_p_y)&gt;lim_y_offset\n            lim_y_offset = abs(max_p_y-min_p_y);\n        end\n        g(j).YLim=[min_p_y-0.05*lim_y_offset max_p_y+0.05*lim_y_offset];\n        g(j).XLim=[0 time_window];\n    else \n        p(j).XData = t(1:ii);\n        p(j).YData = p_y(j,1:ii);\n        min_p_y = min(p_y(j,ceil(ii-0.7*time_window/dt):ii));\n        max_p_y = max(p_y(j,ceil(ii-0.7*time_window/dt):ii));\n        lim_y_offset = 10;\n        if abs(max_p_y-min_p_y)&gt;lim_y_offset\n            lim_y_offset = abs(max_p_y-min_p_y);\n        end\n        g(j).YLim=[min_p_y-0.05*lim_y_offset max_p_y+0.05*lim_y_offset];\n        if time+0.3*time_window &lt; t(end)\n            g(j).XLim=[time-0.7*time_window time+0.3*time_window];\n        else\n            g(j).XLim=[t(end)-time_window t(end)];\n        end\n    end\nend\n\n%%字體\nTime_txt.String=['time: ', num2str(t(ii),'%5.2f') ,' s'];\n\n\ndrawnow limitrate;\nwriteVideo(writerObj,getframe(video));\nend\n\n%% 最後暫停畫面\nii=length(t);\n%透明球\nball.XData = bal.x + data.P(1,ii);\nball.YData = bal.y + data.P(2,ii);\nball.ZData = bal.z + data.P(3,ii);\n\n%機架\nF450_dcm = angle2dcm (data.psi(ii),data.theta(ii),data.phi(ii));\nF450_RT = [F450_dcm',data.P(:,ii);[0,0,0,1]];\nF450_F450_poinit_new  = (F450_RT*[F450_poinit';ones(1,length(F450_poinit))])';\nF450_F450_poinit_new=F450_F450_poinit_new(:,1:3);\nF450.Vertices = F450_F450_poinit_new;\n\n%槳葉\nfor j=1:4\n    propeller_deg(j) = propeller_deg(j) + (-1)^(j)*0.3*pi;\n    propeller_RT_B_to_motor&#123;j&#125; = [angle2dcm(propeller_deg(j),0,0)' propeller_offset&#123;j&#125;;[0,0,0,1]];\n    propeller_F450_poinit_new  = (F450_RT*propeller_RT_B_to_motor&#123;j&#125;*[propeller_poinit';ones(1,length(propeller_poinit))])';\n    propeller_F450_poinit_new=propeller_F450_poinit_new(:,1:3);\n    propeller&#123;j&#125;.Vertices = propeller_F450_poinit_new;\nend\n\n%%字體\nTime_txt.String=['time: ', num2str(t(ii),'%5.2f') ,' s'];\ndrawnow limitrate;\nwriteVideo(writerObj,getframe(video));\nfor i=1:25%結束暫停影像\n    writeVideo(writerObj,getframe(video));\nend\n%%%\nclose(writerObj);\n\nfunction new_data=col_row_check(data)\n   new_data=data;\n   [m,n]=size(data);\n   if(m&gt;n)\n     new_data = new_data';\n   end\nend\n</code></pre>\n",
            "tags": []
        },
        {
            "id": "https://to-pro.github.io/matlab/lesson3/",
            "url": "https://to-pro.github.io/matlab/lesson3/",
            "title": "動畫 lesson 3",
            "date_published": "2024-10-23T09:49:19.272Z",
            "content_html": "<p>這一篇基於前一篇引入 STL 後，將四旋翼模型拆分成機架與槳葉。這樣拆分引入可以在後面繪製動畫時使螺旋槳各自轉動。</p>\n<h3 id=\"成果展示\"><a class=\"anchor\" href=\"#成果展示\">#</a> 成果展示:</h3>\n<p><img data-src=\"lesson3.png\" alt=\"alt text\" /></p>\n<p>範例的 STL 可以在這邊下載:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2RyaXZlL2ZvbGRlcnMvMUxBbUlWNzFuUTRtaHVQUWxnWm5PNDVGZjBKUEN2Z3Z3P3VzcD1kcml2ZV9saW5r\"> 載點</span></p>\n<h3 id=\"程式碼\"><a class=\"anchor\" href=\"#程式碼\">#</a> 程式碼:</h3>\n<pre><code class=\"language-MATLAB\">clc;clear;close all\naddpath(genpath('.\\450'))%路徑可能需要更改\n\n%機架\nF450_raw = stlread(&quot;F450_no_propeller.stl&quot;);\nF450_poinit = F450_raw.Points;           %取點\nF450_conn = F450_raw.ConnectivityList;   %取三角形\nclear F450_raw;\nF450_triang = triangulation(F450_conn,F450_poinit);\nF450 = trisurf(F450_triang,'facecolor',[0.9,0.9,0.8],'edgecolor','none');\nhold on\n\n\n%槳葉\npropeller_raw = stlread(&quot;propeller.stl&quot;);\npropeller_poinit = propeller_raw.Points;           %取點\npropeller_conn = propeller_raw.ConnectivityList;   %取三角形\nclear propeller_raw;\npropeller_triang = triangulation(propeller_conn,propeller_poinit);\n\nfor i=1:4\n    propeller&#123;i&#125; = trisurf(propeller_triang,'facecolor',[0 0 0],'edgecolor','none');\nend\n\n\npropeller_RT_B_to_motor = cell(4,1);\npropeller_RT_B_to_motor&#123;1&#125; = [angle2dcm(pi*0.1,0,0)' [ 159.1;  159.1; 196.7500]*0.001;[0,0,0,1]];\npropeller_RT_B_to_motor&#123;2&#125; = [angle2dcm(pi*0.2,0,0)' [-159.1;  159.1; 196.7500]*0.001;[0,0,0,1]];\npropeller_RT_B_to_motor&#123;3&#125; = [angle2dcm(pi*0.3,0,0)' [-159.1; -159.1; 196.7500]*0.001;[0,0,0,1]];\npropeller_RT_B_to_motor&#123;4&#125; = [angle2dcm(pi*0.4,0,0)' [ 159.1; -159.1; 196.7500]*0.001;[0,0,0,1]];\n\nfor i=1:4\npropeller_poinit_new  = (propeller_RT_B_to_motor&#123;i&#125;*[propeller_poinit';ones(1,length(propeller_poinit))])';\npropeller_poinit_new=propeller_poinit_new(:,1:3);\npropeller&#123;i&#125;.Vertices = propeller_poinit_new;\nend\naxis equal\n\n% axis vis3d\nbox on \ncamlight(&quot;headlight&quot;)%打光\nxlabel(&quot;x&quot;)\nylabel(&quot;y&quot;)\nzlabel(&quot;z&quot;)\n</code></pre>\n",
            "tags": []
        },
        {
            "id": "https://to-pro.github.io/matlab/lesson2/",
            "url": "https://to-pro.github.io/matlab/lesson2/",
            "title": "動畫 lesson 2",
            "date_published": "2024-10-23T09:49:18.110Z",
            "content_html": "<p>這一篇將介紹如何在 MATLAB 中的 Figure 中引入 STL 檔案。</p>\n<p>首先了解 STL 是甚麼可以參考:<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYWRvYmUuY29tL3R3L2NyZWF0aXZlY2xvdWQvZmlsZS10eXBlcy9pbWFnZS92ZWN0b3Ivc3RsLWZpbGUuaHRtbA==\"> 了解 STL 檔案格式</span>。不論是從網路或是使用 Solid work 自己繪製。都可以獲得 STL 檔案的模型。檔案中主要內容是點跟向量。向量表示那些點組成三角形表面。這裡特別建議 STL 檔案中的原點最好在使用前先用程式設定好，用 MATLAB 內建的可以調整與儲存但麻煩許多也不直觀。</p>\n<h3 id=\"成果展示\"><a class=\"anchor\" href=\"#成果展示\">#</a> 成果展示:</h3>\n<p><img data-src=\"lesson2.png\" alt=\"alt text\" /></p>\n<p>範例的 STL 可以在這邊下載:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2RyaXZlL2ZvbGRlcnMvMUxBbUlWNzFuUTRtaHVQUWxnWm5PNDVGZjBKUEN2Z3Z3P3VzcD1kcml2ZV9saW5r\"> 載點</span></p>\n<h3 id=\"程式碼\"><a class=\"anchor\" href=\"#程式碼\">#</a> 程式碼:</h3>\n<pre><code class=\"language-MATLAB\">% plot stl and animation example \nclc;clear;close all\naddpath(genpath('.\\STL\\250'))%路徑需要更改\n% addpath說明\n% 1、文件在当前路径下：使用 load('***.mat')\n% 2、文件在下一级路径下：使用 load (' .\\下一级路径的文件名\\***.mat ');\n% 3、文件在上一级路径下：使用 load (' ..\\***.mat ');\n% 4、文件在平行文件夹内：使用 load (' ..\\平行的文件夹\\***.mat');\n\n%%\nDrone_raw = stlread(&quot;250.STL&quot;);\nDrone_poinit = Drone_raw.Points;         %取點\nDrone_conn = Drone_raw.ConnectivityList; %取三角形資料\npoint_x= mean(Drone_poinit(:,1),1);      %置中(但原點最好前處理解決掉，例如在SW中轉STL時就設定好重心位置)\nDrone_poinit(:,1) = Drone_poinit(:,1)-point_x;\nDrone_triang = triangulation(Drone_conn,Drone_poinit);%stlwrite(F_16_new,&quot;F_16_new.stl&quot;)\nDrone = trisurf(Drone_triang,'facecolor',[0.9,0.9,0.8],'edgecolor','none');\n\n% axis equal\naxis vis3d\n\nbox on \ncamlight(&quot;headlight&quot;)%打光\nxlabel(&quot;x&quot;)\nylabel(&quot;y&quot;)\nzlabel(&quot;z&quot;)\n\n%% rotate\nDrone_poinit_new = Drone_poinit;\n\nfor i = 0:0.5:360\n    Drone_position = [0;0;i/360/2]; %高度升到0.5米\n    Drone_dcm = angle2dcm (0,0,i/360*2*pi); %內建的DCM會與推導的差一個轉置\n    Drone_RT = [Drone_dcm' Drone_position;[0 0 0 1]];\n    Drone_poinit_new  = (Drone_RT*[Drone_poinit';ones(1,length(Drone_poinit))])';\n    Drone.Vertices = Drone_poinit_new(:,1:3);\n    zlim([0,inf]);\n    drawnow limitrate\nend\n</code></pre>\n",
            "tags": []
        },
        {
            "id": "https://to-pro.github.io/matlab/lesson1/",
            "url": "https://to-pro.github.io/matlab/lesson1/",
            "title": "動畫 lesson 1",
            "date_published": "2024-10-23T09:49:14.589Z",
            "content_html": "<p>本篇以一個簡單的例子說明如何用 MATLAB 函數。繪製目標為將函數 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">sin(2t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 以動畫形式展現。</p>\n<h3 id=\"主要函數介紹\"><a class=\"anchor\" href=\"#主要函數介紹\">#</a> 主要函數介紹:</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvdmlkZW93cml0ZXIuaHRtbA==\">VideoWriter</span>: 建立視訊物件。主要要設定 Quality 和 FrameRate。Quality 是質量基本上設定上限 100。FrameRate 則是幀數，每秒幾張圖須配合寫入做調整。</p>\n<p>簡單舉例:</p>\n<pre><code class=\"language-MATLAB\">writerObj = VideoWriter(video_name,'MPEG-4');\nwriterObj.FrameRate = 25; %每秒幾張圖\nwriterObj.Quality = 100;\nopen(writerObj);\n\n% 開始錄製(用迴圈)\nfor i=1:n\n%\n% 更新畫面....\n%\ndrawnow limitrate;% 立即繪製\nwriteVideo(writerObj,getframe(video));\nend\n\n% 結束錄製\nclose(writerObj);%一定要關閉才能錄製成功\n</code></pre>\n<h3 id=\"成果展示\"><a class=\"anchor\" href=\"#成果展示\">#</a> 成果展示:</h3>\n<p>前後暫停 1 秒。並且時間窗格設定為 5 秒，會跟著當前時間顯示函數。<br />\n<img data-src=\"lesson1.png\" alt=\"alt text\" /></p>\n<h3 id=\"程式碼\"><a class=\"anchor\" href=\"#程式碼\">#</a> 程式碼:</h3>\n<pre><code class=\"language-MATLAB\">clc;clear;close all;\n\n%% 生成資料\ndt = 0.01;\nt_end = 10;\nt = 0:dt:t_end;\ny = sin(2*t);\nvideo_name = 'sin wave';\ntime_window = 5;%Unit:sec\n\n%% 繪圖\nvideo=figure();\nset(video,'Position',[1 49 1.7067e+03 946]); %需放大錄製，不然畫質很差\np1 = plot(t,y(1,:),&quot;Color&quot;,&quot;b&quot;,&quot;LineStyle&quot;,&quot;-&quot;,&quot;LineWidth&quot;,2);\nhold on\ncircle = plot(0,y(1),&quot;Color&quot;,&quot;r&quot;,&quot;LineStyle&quot;,&quot;none&quot;,&quot;Marker&quot;,&quot;o&quot;,&quot;MarkerSize&quot;,10,&quot;LineWidth&quot;,2);\nxlim tight\nylim padded\nylabel(&quot;$\\sin (2t)$&quot;,&quot;Interpreter&quot;,&quot;latex&quot;);\nxlabel(&quot;Time (s)&quot;,&quot;Interpreter&quot;,&quot;latex&quot;);\ngrid on %打開網格 \ng1 = gca;\ng1.FontSize = 20;\n\n% 顯示時間\nTime_txt=text('String',['time: ', '00.00' ,' s'],...\n              'Interpreter','latex',...\n              'FontSize',30,...\n              'Units','normalized',...\n              'Position',[ 0.8 1.04]);\n\n%% 錄影設定\nwriterObj = VideoWriter(video_name,'MPEG-4');\nwriterObj.FrameRate = 25; %每秒幾張圖(如要顯示時間要注意這個設定)\nwriterObj.Quality = 100;\nopen(writerObj);\n\n%% 起始前暫停影像\np1.XData = t(1:1);\np1.YData = y(1,1);\n\ncircle.XData = t(1);\np1.YData = y(1,1);\n\nmin_y = min(y(1:1));\nmax_y = max(y(1:1));\nlim_y_offset = 5;\nif abs(max_y-min_y)&gt;lim_y_offset\n    lim_y_offset = abs(max_y-min_y);\nend\ng1.YLim=[min_y-0.05*lim_y_offset max_y+0.05*lim_y_offset];\ng1.XLim=[0 time_window];\n\nfor i=1:25 %暫停一秒 \n     writeVideo(writerObj,getframe(video));\nend\n\n\n%% 開始錄製\nfor i = 1:length(t)/4\nii = 4*i;\n\ntime = t(ii);\np1.XData = t(1:ii);\np1.YData = y(1,1:ii);\n\ncircle.XData = t(ii);\ncircle.YData = y(1,ii);\n\n\n% 檢測顯示線的Y方向最大刻度\nmin_y = min(y(1:ii));\nmax_y = max(y(1:ii));\nlim_y_offset = 10; % 設定最小Y軸長度\nif abs(max_y-min_y)&gt;lim_y_offset\n    lim_y_offset = abs(max_y-min_y);\nend\ng1.YLim=[min_y-0.05*lim_y_offset max_y+0.05*lim_y_offset];% 設定Y軸\n\n% 設定X軸\nif (time &lt; 0.7*time_window)\n    g1.XLim=[0 time_window];\nelse\n    g1.XLim=[time-0.7*time_window time+0.3*time_window];\nend\n\n% 文字更新\nTime_txt.String=['time: ', num2str(t(ii),'%5.2f') ,' s'];\n\ndrawnow limitrate;% 立即繪製\nwriteVideo(writerObj,getframe(video));\nend\n\n%% 最後暫停畫面(主要是讓時間可以顯示整數)\n% 子圖更新\nii = length(t);\ntime = t(ii);\np1.XData = t(1:ii);\np1.YData = y(1,1:ii);\n\ncircle.XData = t(ii);\ncircle.YData = y(1,ii);\n\n\n% 檢測顯示線的Y方向最大刻度\nmin_y = min(y(1:ii));\nmax_y = max(y(1:ii));\nlim_y_offset = 10; % 設定最小Y軸長度\nif abs(max_y-min_y)&gt;lim_y_offset\n    lim_y_offset = abs(max_y-min_y);\nend\ng1.YLim=[min_y-0.05*lim_y_offset max_y+0.05*lim_y_offset];% 設定Y軸\n\n% 設定X軸\nif (time &lt; 0.7*time_window)\n    g1.XLim=[0 time_window];\nelse\n    g1.XLim=[time-0.7*time_window time+0.3*time_window];\nend\n\n% 文字更新\nTime_txt.String=['time: ', num2str(t(ii),'%5.2f') ,' s'];\nfor i=1:25 %結束暫停影像(一秒)\n    writeVideo(writerObj,getframe(video));\nend\nclose(writerObj);%一定要關閉才能錄製成功\n\n</code></pre>\n<h3 id=\"回家作業\"><a class=\"anchor\" href=\"#回家作業\">#</a> 回家作業</h3>\n<p>配合前一份旋轉方塊的程式碼，可以用它展示姿態變化。</p>\n",
            "tags": []
        },
        {
            "id": "https://to-pro.github.io/matlab/note_part2/",
            "url": "https://to-pro.github.io/matlab/note_part2/",
            "title": "Matlab figure 筆記2",
            "date_published": "2023-03-21T03:53:08.909Z",
            "content_html": "<h3 id=\"示範在空間中畫一個方塊-並運用方向餘弦矩陣dcm畫不同姿態的方塊\"><a class=\"anchor\" href=\"#示範在空間中畫一個方塊-並運用方向餘弦矩陣dcm畫不同姿態的方塊\">#</a> 示範在空間中畫一個方塊。並運用方向餘弦矩陣 (DCM)，畫不同姿態的方塊</h3>\n<p>重點函數說明:<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvcGF0Y2guaHRtbA==\">patch</span> 畫方塊</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvcXVpdmVyMy5odG1s\">quiver3</span> 畫箭頭</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL2Flcm90YngvdWcvYW5nbGUyZGNtLmh0bWw=\">angle2dcm</span> 產生方向餘弦矩陣來旋轉方塊 (預設為 (yaw,pitch,roll))</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvZHJhd25vdy5odG1s\">drawnow</span> 更新 figure</p>\n<pre><code class=\"language-MATLAB\">clc;clear;close all;\n\nfig(1) = figure(&quot;Name&quot;,&quot;cube&quot;);\nvertices = [-0.5 -0.5 -0.5;\n             0.5 -0.5 -0.5;\n             0.5  0.5 -0.5;\n            -0.5  0.5 -0.5;\n            -0.5 -0.5  0.5;\n             0.5 -0.5  0.5;\n             0.5  0.5  0.5;\n            -0.5  0.5  0.5];%正方體有八個頂點\nfaces = [1 2 6 5;2 3 7 6;3 4 8 7;4 1 5 8;1 2 3 4;5 6 7 8];%其6個面的頂點，點的順序根據vertices\ncube = patch('Vertices',vertices,'Faces',faces,'Facecolor','none');\nVx_ini = [1 0 0]';\nVy_ini = [0 1 0]';\nVz_ini = [0 0 1]';\nVx = [1 0 0]';\nVy = [0 1 0]';\nVz = [0 0 1]';\nhold on\nXaxis = quiver3(0,0,0,Vx(1),Vx(2),Vx(3),1.5,'r','filled','Linewidth',2);\nYaxis = quiver3(0,0,0,Vy(1),Vy(2),Vy(3),1.5,'g','filled','Linewidth',2);\nZaxis = quiver3(0,0,0,Vz(1),Vz(2),Vz(3),1.5,'b','filled','Linewidth',2);\nax=gca;\nax.FontSize = 14;\nax.FontName = 'Times New Roman';\ngrid on %開網格\nview(3) %3D來看\naxis equal  %沿每個軸對數據單位使用相同的長度。\naxis([-1.5 2.2 -1.5 2.2 -1.5 2.2]);\n\nn = 7;\nfor i = 1:n\ndcm = angle2dcm (pi/4*(i-1),0,0);%旋轉餘弦矩陣\n\ncube.Vertices = vertices*dcm;\nVx=dcm'*Vx_ini;\nVy=dcm'*Vy_ini;\nVz=dcm'*Vz_ini;\nXaxis.UData=Vx(1);Xaxis.VData=Vx(2);Xaxis.WData=Vx(3);\nYaxis.UData=Vy(1);Yaxis.VData=Vy(2);Yaxis.WData=Vy(3);\nZaxis.UData=Vz(1);Zaxis.VData=Vz(2);Zaxis.WData=Vz(3);\n\ndrawnow;%以新的姿態重新繪製方塊\nif(i&lt;n)\n    fprintf(&quot;Press any key to continue.\\n&quot;);\n    pause;%暫停直到按任意鍵\nelse\n    fprintf(&quot;Rotation display ends.\\n&quot;);\nend\n\nend\n</code></pre>\n<p>圖:<br />\n<img data-src=\"https://imgur.com/dTdj4Zz.jpg\" alt=\"Imgur\" /></p>\n",
            "tags": []
        },
        {
            "id": "https://to-pro.github.io/matlab/note_part1/",
            "url": "https://to-pro.github.io/matlab/note_part1/",
            "title": "Matlab figure 筆記1",
            "date_published": "2023-03-21T03:53:08.899Z",
            "content_html": "<h2 id=\"繪圖的精神為清晰明顯的表達所有資訊\"><a class=\"anchor\" href=\"#繪圖的精神為清晰明顯的表達所有資訊\">#</a> 繪圖的精神為清晰明顯的表達所有資訊</h2>\n<p>此次所用資料生成<br />\n假設有如下生成的資料需要繪圖</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>clc<span class=\"token punctuation\">;</span>clear<span class=\"token punctuation\">;</span>close all<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>addpath <span class=\"token string\">'Z:\\My Drive\\matlab\\plot_function'</span><span class=\"token comment\">% 本人自訂函數存放處</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>dt <span class=\"token operator\">=</span> <span class=\"token number\">0.001</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>t_end <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>t <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span>dt<span class=\"token operator\">:</span>t_end<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>theta <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span><span class=\"token function\">exp</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">exp</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.6</span><span class=\"token operator\">*</span>t<span class=\"token punctuation\">)</span><span class=\"token operator\">.*</span><span class=\"token number\">0.1</span><span class=\"token operator\">.*</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token operator\">*</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>noise <span class=\"token operator\">=</span> <span class=\"token number\">0.01</span><span class=\"token operator\">*</span><span class=\"token function\">randn</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>theta_m <span class=\"token operator\">=</span> theta <span class=\"token operator\">+</span> noise<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"基本的繪圖\"><a class=\"anchor\" href=\"#基本的繪圖\">#</a> 基本的繪圖</h2>\n<p>基本上繪圖要有</p>\n<blockquote>\n<p>X 座標 (含單位)<br />\n Y 座標 (含單位)<br />\n 圖例 (當此圖有多條線時)<br />\n 標題 (可有可無，可在報告中的標號時說明)</p>\n</blockquote>\n<p>其中 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvcGxvdC5odG1s\">plot</span> (建議多參考官網的說明) 有幾個重要屬性基本都要調整使其繪的圖可以清晰，<mark>LineStyle</mark>、<mark>Color</mark> 和<mark> LineWidth</mark>。<br />\n以下示範簡單繪製<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span> 與<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\theta_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 在同一張圖。因為<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\theta_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 含有噪音，要優先畫才不會蓋到<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span>\"Name\"<span class=\"token punctuation\">,</span>\"state\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>r\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>b\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span>\"<span class=\"token operator\">\\</span>theta\"<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">\\</span>theta_m\"<span class=\"token punctuation\">)</span><span class=\"token comment\">% 圖例</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token function\">Time</span> <span class=\"token punctuation\">(</span>sec<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% X 座標名稱</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token operator\">\\</span><span class=\"token function\">theta</span> <span class=\"token punctuation\">(</span>rad<span class=\"token operator\">/</span>s<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% Y 座標名稱</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">title</span><span class=\"token punctuation\">(</span>\"Response\"<span class=\"token punctuation\">)</span><span class=\"token comment\">% 標題</span></pre></td></tr></table></figure><p><img data-src=\"https://i.imgur.com/wjzXxqV.png\" alt=\"img\" /><br />\n 此程式碼繪的圖有幾個問題</p>\n<blockquote>\n<p>線粗細可以在粗一些<br />\n圖例擋到線<br />\n字太小 (這要根據你最終要放到的報告中調整，簡單來說要與報告內文相同)<br />\n 不知道最終值是不是在 1 附近</p>\n</blockquote>\n<h2 id=\"高級的繪圖\"><a class=\"anchor\" href=\"#高級的繪圖\">#</a> 高級的繪圖</h2>\n<p>除了剛剛的缺點，這裡還更改了圖例顯示的順序，用物件接住 plot，在對此物件標示圖例，此法可以延伸應用到僅標示要標示的線 (參考雙 Y 軸圖的程式碼)</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'response'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span><span class=\"token string\">'-r'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'LineWidth'</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span><span class=\"token string\">'-b'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'LineWidth'</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta_m'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'location'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'southeast'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% X 座標名稱</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\theta (rad/s)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% Y 座標名稱</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Response'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">% 標題</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>ax <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'FontSize'</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'FontName'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Times New Roman'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'XGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'YGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>ax<span class=\"token punctuation\">.</span>TitleFontSizeMultiplier<span class=\"token operator\">=</span><span class=\"token number\">1.3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'XMinorGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'YMinorGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"https://imgur.com/BVXeQTb.png\" alt=\"img\" /><br />\n 小提示：每個東西都有很多屬性可以設定。令一個變數接住，並且後面不加分號。你就能在 Command Window 看到新世界 (有很多屬性可以調整)。將上面程式碼中的 legend 改成像這樣</p>\n<pre><code>l = legend(p,'\\theta_m','\\theta')\n</code></pre>\n<h2 id=\"繪圖函數設定\"><a class=\"anchor\" href=\"#繪圖函數設定\">#</a> 繪圖函數設定</h2>\n<p>因為每張圖都有類似的共同的設定，因此將其包成函數，以後畫圖就很輕鬆，這是我常用的繪圖設定函數</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span>varargin<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>nInputs <span class=\"token operator\">=</span> nargin<span class=\"token punctuation\">;</span><span class=\"token comment\">% 偵測輸入有幾個變數</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span> nInputs <span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token comment\">% 若只有一個變數就是字體大小的設定值</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    ax_FontSize <span class=\"token operator\">=</span> varargin<span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    ax_FontSize <span class=\"token operator\">=</span> varargin<span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 字體大小的設定值</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    Line_width <span class=\"token operator\">=</span> varargin<span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 所有 plot 的線粗細設定值</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>ax <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span><span class=\"token comment\">% 當前座標區或圖</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'FontSize'</span><span class=\"token punctuation\">,</span>ax_FontSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 字體大小設定</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'FontName'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Times New Roman'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 字體設定</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'XGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'YGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 開網格</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span><span class=\"token string\">'XMinorGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'YMinorGrid'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'on'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 開更密的網格</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>ax<span class=\"token punctuation\">.</span>TitleFontSizeMultiplier<span class=\"token operator\">=</span><span class=\"token number\">1.3</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 標題與一般文字大小的放大倍率</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">% 所有 plot 的線粗細設定</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">if</span> nInputs <span class=\"token operator\">==</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>plot_num <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">.</span>Children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% ax.Children 就是 figure 裡 plot 的線</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> plot_num</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">%     ax.Children (i).LineStyle = '-';% 統一線的樣式 (通常多條線就要不一樣)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    ax<span class=\"token punctuation\">.</span><span class=\"token function\">Children</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>LineWidth <span class=\"token operator\">=</span> Line_width<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr></table></figure><p>則使用以下程式碼就能畫出相同的圖</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span>\"Name\"<span class=\"token punctuation\">,</span>\"state\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>r\"<span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span>\"<span class=\"token operator\">-</span>b\"<span class=\"token punctuation\">,</span>\"LineWidth\"<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span>\"<span class=\"token operator\">\\</span>theta_m\" \"<span class=\"token operator\">\\</span>theta\"<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\"location\"<span class=\"token punctuation\">,</span>\"best\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token function\">Time</span> <span class=\"token punctuation\">(</span>sec<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">,</span>\"Interpreter\"<span class=\"token punctuation\">,</span>\"latex\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% X 座標名稱</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span>\"<span class=\"token operator\">\\</span><span class=\"token function\">theta</span> <span class=\"token punctuation\">(</span>rad<span class=\"token operator\">/</span>s<span class=\"token punctuation\">)</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% Y 座標名稱</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">title</span><span class=\"token punctuation\">(</span>\"Response\"<span class=\"token punctuation\">)</span><span class=\"token comment\">% 標題</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"子母圖\"><a class=\"anchor\" href=\"#子母圖\">#</a> 子母圖</h2>\n<p>有時需要放大圖中某個地方等需求，就可以這樣畫<br />\n<img data-src=\"https://imgur.com/Yguh8h3.png\" alt=\"Imgur\" /><br />\n 程式碼如下</p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>ab</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'response'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span><span class=\"token string\">'-r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span><span class=\"token string\">'-b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta_m'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'location'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'southeast'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% X 座標名稱</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\theta (rad/s)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% Y 座標名稱</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Response'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">% 標題</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">axes</span><span class=\"token punctuation\">(</span><span class=\"token string\">'position'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.45</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.40</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">% 子圖位置與大小 [距圖左邊距離 距圖下邊距離 子圖寬 子圖高]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span><span class=\"token string\">'-r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span><span class=\"token string\">'-b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">axis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span> <span class=\"token number\">10</span> <span class=\"token operator\">-</span><span class=\"token keyword\">inf</span> <span class=\"token keyword\">inf</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>ylim <span class=\"token string\">'padded'</span><span class=\"token comment\">% padded 為邊距的寬度約為數據范圍的 7%</span></pre></td></tr></table></figure><h2 id=\"雙y軸圖\"><a class=\"anchor\" href=\"#雙y軸圖\">#</a> 雙 Y 軸圖</h2>\n<p>有時要繪製在一起的資料量級相差太大，但又想繪製在一起觀察，就可以考慮有效利用兩邊 Y 軸來繪圖<br />\n<img data-src=\"https://imgur.com/pZHZdZi.png\" alt=\"Imgur\" /></p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>ab</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'All'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span><span class=\"token string\">'-r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">p</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span><span class=\"token string\">'-b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% X 座標名稱</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\theta (rad/s)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 左邊 Y 座標名稱</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">title</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Response'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">% 標題</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>yyaxis right <span class=\"token comment\">% 改右邊 Y 軸來畫</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>input<span class=\"token punctuation\">,</span><span class=\"token string\">'-m'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>hold on</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'voltage (V)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Color'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">% 右邊 Y 座標名稱</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>ax <span class=\"token operator\">=</span> gca<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>ax<span class=\"token punctuation\">.</span>YColor<span class=\"token operator\">=</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">legend</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta_m'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'\\theta'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'location'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>ylim <span class=\"token string\">'padded'</span><span class=\"token comment\">% padded 為邊距的寬度約為數據范圍的 7%</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9tYXRsYWJjZW50cmFsL2Fuc3dlcnMvMTY2MTI5NS1ob3ctdG8tc2V0LWZyb250LWFuZC1iYWNrLWxpbmVzLW9uLXBsb3Qtd2l0aC15eWF4aXMtbGVmdC1hbmQtcmlnaHQ=\">前後問題改起來很麻煩可以參考這裡解決</span></p>\n<h2 id=\"用迴圈存圖\"><a class=\"anchor\" href=\"#用迴圈存圖\">#</a> 用迴圈存圖</h2>\n<p>最後耍帥的用程式碼將全部圖片存到指定地點，後續可用 Latex 自動讀檔製作報告，使用函數<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9oZWxwL21hdGxhYi9yZWYvcHJpbnQuaHRtbA==\"> print</span></p>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"><span>b</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'theta'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta<span class=\"token punctuation\">,</span><span class=\"token string\">'-b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'voltage (V)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">end</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'theta_m'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>theta_m<span class=\"token punctuation\">,</span><span class=\"token string\">'-r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'voltage (V)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">end</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token function\">figure</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">plot</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span>input<span class=\"token punctuation\">,</span><span class=\"token string\">'-m'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">xlabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Time (sec)'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Interpreter'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'latex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">ylabel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'voltage (V)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">plot_set</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token number\">i</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>fig<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>     <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Z:\\My Drive\\matlab\\example\\Figure\\'</span> <span class=\"token function\">fig</span><span class=\"token punctuation\">(</span><span class=\"token number\">i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-depsc'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr></table></figure><p>備註：這裡設定 -depsc 是存成向量檔 (.eps)，放大才不會有像素感。</p>\n",
            "tags": []
        }
    ]
}